<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Pentester&#39;s Fallacy</title>
    <meta name="description" content="The probability of A given B does not equal the probability of B given A.">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Risky Hacker">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="Risky Hacker">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/">Risky Hacker</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/">Home</a></li>
        <li class="nav-item"><a href="/posts/">Archive</a></li>
        <li class="nav-item"><a href="/about/">About</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>The Pentester&#39;s Fallacy</h1>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
<blockquote>
<p>The probability of A given B does not equal the probability of B given A.</p>
</blockquote>
<h2 id="the-inequality">The Inequality <a class="direct-link" href="#the-inequality">#</a></h2>
<p>$$ P(A|B) \ne P(B|A) $$</p>
<p>In it's simpliest form, the preceding inequality could be stated as <em>The probability of being a woman given that you are pregnant <strong>is not equal</strong> to the probability of being pregnant given you are are woman.</em> The probability of <em>being a woman given you are pregnant</em> is certain, whereas the probability of <em>being pregnant given you are a woman</em> is definitely NOT certain. Phrased another way, the probability of being a woman given you are pregnant is close to 100% while the probability of being pregnant given you a woman is opposite.</p>
<h2 id="the-prosecutor">The Prosecutor <a class="direct-link" href="#the-prosecutor">#</a></h2>
<p>Another experiment could model police searching for a criminal. The description for the criminal is <em>Male, 6ft tall, Red Hair, Pronounced Limp.</em> A particularly observant police officer observes a man matching the description carrying a new flat screen television and the suspect is taken into custody. The prosecution may argue there is a 1 in 500,000 chance of an <strong>innocent</strong> man matching this description. <strong>However</strong>, that does not mean there is a 1 in 500,000 chance the man is innocent. Supposing 1 in 20 people match the description, there is a 19 in 20 chance the suspect is innocent.</p>
<h2 id="the-pentester">The Pentester <a class="direct-link" href="#the-pentester">#</a></h2>
<h3 id="scenario-i">Scenario I <a class="direct-link" href="#scenario-i">#</a></h3>
<p>Applied to Penetration Testing, the following claim demonstrates the fallacy in the context of a host during self attestation. An auditor may argue there is a 1 in 500,000 chance of a non-vulnerable host matching a vulnerability signature. <strong>However</strong>, that does not mean there is a 1 in 500,000 chance the host is non-vulnerable. Supposing 1 in 20 hosts match the vulnerability signature, there is a 19 in 20 chance the host in question is not vulnerable.</p>
<p>If the vulnerability signature match is used to confirm guilt which is otherwise suspected then it is indeed strong evidence. If the vulnerability signature match is the sole evidence against the accused host and the accused host was picked out of a large database of vulnerable profiles, the odds of the match being made at random may be increased, and less damaging to the hostâ€™s security score.</p>
<h3 id="scenario-ii">Scenario II <a class="direct-link" href="#scenario-ii">#</a></h3>
<p>In another scenario, a vulnerable host is compared against a database of 20,000 hosts. A vulnerability signature violation is found, that host is attested such that that the probability that two vulnerability profiles match by chance is only 1 in 10,000. This does not mean the probability that the host is innocent is 1 in 10,000. Since 20,000 hosts were tested, there were 20,000 opportunities to find a match by chance. Even if none of the hosts in the database are vulnerable, a match by chance to an innocent host is more likely than not.</p>
<p>The odds in this scenario do not relate to the odds of being guilty, they relate to the odds of being picked at random. While the odds of being picked at random may be low for an individual condition implying guilt, i.e. a positive vulnerability match, the probability of being picked at random for any condition grows to 1 as more conditions are considered, as is the case in multiple testing.</p>
<p>It is often the case that both innocence and guilt are both highly improbable, though naturally one must be true, so the ratio of the likelihood of the vulnerable scenario to the not vulnerable scenario is much more informative than the probability of the vulnerable scenario alone.</p>
<h2 id="the-math">The Math <a class="direct-link" href="#the-math">#</a></h2>
<p>Given the following definitions and suppositions:</p>
<ul>
<li>Rule table
<blockquote>
<p>The criterion for identifying vulnerable or not vulnerable</p>
</blockquote>
</li>
<li>Let <strong>I</strong> represent the event that a host does not violate a rule table</li>
<li>Let <strong>E</strong> be the evidence of violating a rule table</li>
<li>Let <strong>V</strong> represent the event that a rule table confirms a vulnerability</li>
</ul>
<p>Suppose the chance of violating a rule table given evidence is 1 in 1 million, but the chance of a rule table match given a non-vulnerable host is 1 in 10 million even when rule tables are taken into account.</p>
<!-- <a href="/posts/hacking-reference/">Hacking Reference</a>
<a href="/posts/extreme-risk/">This Post</a> -->


<hr>
<ul><li>Next: <a href="/posts/hacker-battle-drills/">Hacker Battle Drills</a></li><li>Previous: <a href="/posts/hacking-reference/">Hacking Reference</a></li>
</ul>
    </main>

    <footer></footer>

    <!-- Current page: /posts/pentesters-fallacy/ -->
  </body>
</html>
