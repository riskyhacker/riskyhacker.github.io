<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centry</title>
    <meta name="description" content="Under The Wire walkthrough series">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Risky Hacker">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="Risky Hacker">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/">Risky Hacker</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/">Home</a></li>
        <li class="nav-item"><a href="/posts/">Archive</a></li>
        <li class="nav-item"><a href="/about/">About</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>Centry</h1>

<h3 id="getting-into-utw">Getting into UTW <a class="direct-link" href="#getting-into-utw">#</a></h3>
<pre class="language-powershell"><code class="language-powershell"><span class="highlight-line"><span class="token comment"># SSH into UTW on port `22` (password: century1)</span></span><br><span class="highlight-line">ssh century1@century<span class="token punctuation">.</span>underthewire<span class="token punctuation">.</span>tech</span></code></pre>
<h3 id="centry-1">Centry 1 <a class="direct-link" href="#centry-1">#</a></h3>
<p>Objective: Identify build version of PowerShell</p>
<pre><code>
Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century1\desktop&gt; $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.14393.3866
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.14393.3866
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1

PS C:\users\century1\desktop&gt;
</code></pre>
<h3 id="century-2">Century 2 <a class="direct-link" href="#century-2">#</a></h3>
<p>Objective: List file names, Google Invoke-WebRequest (PS version of wget)</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century2\desktop&gt; Get-ChildItem


    Directory: C:\users\century2\desktop


    Mode                LastWriteTime         Length Name
    ----                -------------         ------ ----
    -a----        8/30/2018   3:29 AM            693 443


PS C:\users\century2\desktop&gt; Get-ChildItem | Select-Object -Property Name

    Name
    ----
    443


PS C:\users\century2\desktop&gt; # invoke-webrequest443
</code></pre>
<h3 id="century-3">Century 3 <a class="direct-link" href="#century-3">#</a></h3>
<p>Objective: Count the number of files in a directory</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century3\desktop&gt; Get-ChildItem


    Directory: C:\users\century3\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:29 AM             33 countme1012
-a----        8/30/2018   3:29 AM             33 countme1064
-a----        8/30/2018   3:29 AM             33 countme1079
...
...
...
-a----        8/30/2018   3:29 AM             33 countme929
-a----        8/30/2018   3:29 AM             33 countme972
-a----        8/30/2018   3:29 AM             33 countme996


PS C:\users\century3\desktop&gt; Get-ChildItem | Measure-Object -line

Lines Words Characters Property
----- ----- ---------- --------
  123

PS C:\users\century3\desktop&gt; Get-ChildItem | Measure-Object | select count

Count
-----
  123


PS C:\users\century3\desktop&gt;
</code></pre>
<h3 id="century-4">Century 4 <a class="direct-link" href="#century-4">#</a></h3>
<p>Objective: Read directory with whitespace in file name</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century4\desktop&gt; get-childitem


    Directory: C:\users\century4\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        6/12/2020   5:49 PM                -
d-----        6/12/2020   5:48 PM                61580
d-----        5/23/2020   9:19 PM                asd
d-----        8/30/2018   3:29 AM                Can You Open Me
d-----        7/27/2020  12:43 AM                eReja
d-----         3/8/2020   3:17 AM                folder
d-----        6/10/2020   5:13 AM                hello
d-----        6/10/2020   5:15 AM                hello.txt
d-----        6/12/2020   5:50 PM                zipped
-a----         3/8/2020   2:59 AM              0 61580.zip


PS C:\users\century4\desktop&gt; Get-ChildItem '.\Can You Open Me'


    Directory: C:\users\century4\desktop\Can You Open Me


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:29 AM             24 61580


PS C:\users\century4\desktop&gt;
</code></pre>
<h3 id="century-5">Century 5 <a class="direct-link" href="#century-5">#</a></h3>
<p>Objective: Determine short name of the domain</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century5\desktop&gt; Get-ADDomain


AllowedDNSSuffixes                 : {}
ChildDomains                       : {}
ComputersContainer                 : CN=Computers,DC=underthewire,DC=tech
DeletedObjectsContainer            : CN=Deleted Objects,DC=underthewire,DC=tech
DistinguishedName                  : DC=underthewire,DC=tech
DNSRoot                            : underthewire.tech
DomainControllersContainer         : OU=Domain Controllers,DC=underthewire,DC=tech
DomainMode                         : Windows2016Domain
DomainSID                          : S-1-5-21-758131494-606461608-3556270690
ForeignSecurityPrincipalsContainer : CN=ForeignSecurityPrincipals,DC=underthewire,DC=tech
Forest                             : underthewire.tech
InfrastructureMaster               : utw.underthewire.tech
LastLogonReplicationInterval       :
LinkedGroupPolicyObjects           : {cn={ECB4A7C0-B4E1-41B1-9E89-161CFA679999},cn=policies,cn=system,DC=underthewire,DC=tech,
                                     CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=underthewire,DC=tech}
LostAndFoundContainer              : CN=LostAndFound,DC=underthewire,DC=tech
ManagedBy                          :
Name                               : underthewire
NetBIOSName                        : underthewire
ObjectClass                        : domainDNS
ObjectGUID                         : bdccf3ad-b495-4d86-a94c-60f0d832e6f0
ParentDomain                       :
PDCEmulator                        : utw.underthewire.tech
PublicKeyRequiredPasswordRolling   : True
QuotasContainer                    : CN=NTDS Quotas,DC=underthewire,DC=tech
ReadOnlyReplicaDirectoryServers    : {}
ReplicaDirectoryServers            : {utw.underthewire.tech}
RIDMaster                          : utw.underthewire.tech
SubordinateReferences              : {DC=ForestDnsZones,DC=underthewire,DC=tech, DC=DomainDnsZones,DC=underthewire,DC=tech,
                                     CN=Configuration,DC=underthewire,DC=tech}
SystemsContainer                   : CN=System,DC=underthewire,DC=tech
UsersContainer                     : CN=Users,DC=underthewire,DC=tech



PS C:\users\century5\desktop&gt; Get-WmiObject Win32_ComputerSystem


Domain              : underthewire.tech
Manufacturer        : OpenStack Foundation
Model               : OpenStack Nova
Name                : UTW
PrimaryOwnerName    : UTW_Team
TotalPhysicalMemory : 12582359040



PS C:\users\century5\desktop&gt; $env:USERDOMAIN
underthewire
PS C:\users\century5\desktop&gt;
PS C:\users\century5\desktop&gt; ls


    Directory: C:\users\century5\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:29 AM             54 3347


PS C:\users\century5\desktop&gt;
</code></pre>
<h3 id="century-6">Century 6 <a class="direct-link" href="#century-6">#</a></h3>
<p>Objective: Count the number of subdirectories in a directory</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century6\desktop&gt; Get-ChildItem -Directory | Measure-Object -line

Lines Words Characters Property
----- ----- ---------- --------
  197


PS C:\users\century6\desktop&gt;

</code></pre>
<h3 id="century-7">Century 7 <a class="direct-link" href="#century-7">#</a></h3>
<p>Objective: Locate a given file name (readme) amongst various folders<br>
Key insight: Search in contacts, desktop, documents, downloads, favorites, music or videos</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century7\desktop&gt; Get-ChildItem -Path ..\Desktop,..\Downloads,..\Favorites,..\Music,..\Videos -Filter '*readme*'


    Directory: C:\users\century7\Downloads


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:29 AM              7 Readme.txt


PS C:\users\century7\desktop&gt; Get-Content ..\Downloads\Readme.txt
7points
PS C:\users\century7\desktop&gt;
</code></pre>
<h3 id="century-7-2">Century 7 <a class="direct-link" href="#century-7-2">#</a></h3>
<p>Objective: Count the number of unique entries in a file</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century8\desktop&gt; Get-ChildItem


    Directory: C:\users\century8\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:33 AM          15858 unique.txt


PS C:\users\century8\desktop&gt; Get-Content .\unique.txt | Select-Object -Unique | Measure-Object | select count

Count
-----
  696


PS C:\users\century8\desktop&gt;

</code></pre>
<h3 id="century-9">Century 9 <a class="direct-link" href="#century-9">#</a></h3>
<p>Objective: Locate the 161th word in a file<br>
Key insight: off-by-one error</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century9\desktop&gt; (Get-Content .\Word_File.txt)[161]
pierid
PS C:\users\century9\desktop&gt;
</code></pre>
<h3 id="century-10">Century 10 <a class="direct-link" href="#century-10">#</a></h3>
<p>Objective: Locate the Windows Update service version description</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century10\desktop&gt; Get-ChildItem


    Directory: C:\users\century10\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:34 AM             43 110


PS C:\users\century10\desktop&gt; Get-Service -DisplayName &quot;*update*&quot;

Status   Name               DisplayName
------   ----               -----------
Stopped  tzautoupdate       Auto Time Zone Updater
Stopped  UsoSvc             Update Orchestrator Service for Win...
Stopped  wuauserv           Windows Update


PS C:\users\century10\desktop&gt; Get-Service -Name &quot;Windows Update&quot; | Select-Object *


Name                : wuauserv
RequiredServices    : {rpcss}
CanPauseAndContinue : False
CanShutdown         : False
CanStop             : False
DisplayName         : Windows Update
DependentServices   : {}
MachineName         : .
ServiceName         : wuauserv
ServicesDependedOn  : {rpcss}
ServiceHandle       :
Status              : Stopped
ServiceType         : Win32ShareProcess
StartType           : Manual
Site                :
Container           :


PS C:\users\century10\desktop&gt; Get-WmiObject -Class Win32_Service -Filter &quot;Name='wuauserv'&quot; | Select-Object *


PSComputerName          : UTW
Name                    : wuauserv
Status                  : OK
ExitCode                : 0
DesktopInteract         : False
ErrorControl            : Normal
PathName                : C:\Windows\system32\svchost.exe -k netsvcs
ServiceType             : Share Process
StartMode               : Manual
__GENUS                 : 2
__CLASS                 : Win32_Service
__SUPERCLASS            : Win32_BaseService
__DYNASTY               : CIM_ManagedSystemElement
__RELPATH               : Win32_Service.Name=&quot;wuauserv&quot;
__PROPERTY_COUNT        : 26
__DERIVATION            : {Win32_BaseService, CIM_Service, CIM_LogicalElement, CIM_ManagedSystemElement}
__SERVER                : UTW
__NAMESPACE             : root\cimv2
__PATH                  : \\UTW\root\cimv2:Win32_Service.Name=&quot;wuauserv&quot;
AcceptPause             : False
AcceptStop              : False
Caption                 : Windows Update
CheckPoint              : 0
CreationClassName       : Win32_Service
DelayedAutoStart        : False
Description             : Enables the detection, download, and installation of updates for Windows and other programs. If this service is disabled,
                          users of this computer will not be able to use Windows Update or its automatic updating feature, and programs will not be
                          able to use the Windows Update Agent (WUA) API.
DisplayName             : Windows Update
InstallDate             :
ProcessId               : 0
ServiceSpecificExitCode : 0
Started                 : False
StartName               : LocalSystem
State                   : Stopped
SystemCreationClassName : Win32_ComputerSystem
SystemName              : UTW
TagId                   : 0
WaitHint                : 0
Scope                   : System.Management.ManagementScope
Path                    : \\UTW\root\cimv2:Win32_Service.Name=&quot;wuauserv&quot;
Options                 : System.Management.ObjectGetOptions
ClassPath               : \\UTW\root\cimv2:Win32_Service
Properties              : {AcceptPause, AcceptStop, Caption, CheckPoint...}
SystemProperties        : {__GENUS, __CLASS, __SUPERCLASS, __DYNASTY...}
Qualifiers              : {dynamic, Locale, provider, UUID}
Site                    :
Container               :


PS C:\users\century10\desktop&gt; Get-WmiObject -Class Win32_Service -Filter &quot;Name='wuauserv'&quot; | Select-Object Description

Description
-----------
Enables the detection, download, and installation of updates for Windows and other programs. If this service is disabled, users of this computer wil...

PS C:\users\century10\desktop&gt; (Get-WmiObject -Class Win32_Service -Filter &quot;Name='wuauserv'&quot;).Description.Split(&quot; &quot;)[9]
Windows
PS C:\users\century10\desktop&gt; (Get-WmiObject -Class Win32_Service -Filter &quot;Name='wuauserv'&quot;).Description.Split(&quot; &quot;)[7]
updates
PS C:\users\century10\desktop&gt;
</code></pre>
<h3 id="century-11">Century 11 <a class="direct-link" href="#century-11">#</a></h3>
<p>Objective: Search for hidden files</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century11\desktop&gt; Get-ChildItem -Force -Exclude 'desktop.ini' -Path ..\Desktop,..\Documents,..\Downloads,..\Favorites,..\Music,..\Videos


    Directory: C:\users\century11\Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d--hsl        8/30/2018   3:11 AM                My Music
d--hsl        8/30/2018   3:11 AM                My Pictures
d--hsl        8/30/2018   3:11 AM                My Videos
d-----        6/16/2020  12:17 AM                WindowsPowerShell


    Directory: C:\users\century11\Downloads


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
--rh--        8/30/2018   3:34 AM             30 secret_sauce


PS C:\users\century11\desktop&gt;
</code></pre>
<h3 id="century-12">Century 12 <a class="direct-link" href="#century-12">#</a></h3>
<p>Objective: Determine the name of the Domain Controller</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century12\desktop&gt; Get-ChildItem


    Directory: C:\users\century12\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:34 AM             30 _things


PS C:\users\century12\desktop&gt; Get-ADDomainController | Select-Object Name

Name
----
UTW


PS C:\users\century12\desktop&gt; Get-ADComputer UTW


DistinguishedName : CN=UTW,OU=Domain Controllers,DC=underthewire,DC=tech
DNSHostName       : utw.underthewire.tech
Enabled           : True
Name              : UTW
ObjectClass       : computer
ObjectGUID        : 5ca56844-bb73-4234-ac85-eed2d0d01a2e
SamAccountName    : UTW$
SID               : S-1-5-21-758131494-606461608-3556270690-1000
UserPrincipalName :



PS C:\users\century12\desktop&gt; Get-ADComputer UTW -Properties Description


Description       : i_authenticate
DistinguishedName : CN=UTW,OU=Domain Controllers,DC=underthewire,DC=tech
DNSHostName       : utw.underthewire.tech
Enabled           : True
Name              : UTW
ObjectClass       : computer
ObjectGUID        : 5ca56844-bb73-4234-ac85-eed2d0d01a2e
SamAccountName    : UTW$
SID               : S-1-5-21-758131494-606461608-3556270690-1000
UserPrincipalName :


PS C:\users\century12\desktop&gt; 
</code></pre>
<h3 id="century-13">Century 13 <a class="direct-link" href="#century-13">#</a></h3>
<p>Objective: Count the number of words in a file</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century13\desktop&gt; (Get-Content .\countmywords).Split(&quot; &quot;) | Measure-Object | select count

Count
-----
  755


PS C:\users\century13\desktop&gt;
</code></pre>
<h3 id="century-14">Century 14 <a class="direct-link" href="#century-14">#</a></h3>
<p>Objective: Count the number of occurences of a string in a file</p>
<pre><code>Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\century14\desktop&gt; (Get-Content .\countpolos).Split(&quot; &quot;) | Select-String -Pattern &quot;(?&lt;!\w)polo&quot; | Measure-Object | select count

Count
-----
  153
</code></pre>


<hr>
<ul><li>Next: <a href="/posts/hacking-reference/">Hacking Reference</a></li><li>Previous: <a href="/posts/bandit/">Bandit</a></li>
</ul>
    </main>

    <footer></footer>

    <!-- Current page: /posts/centry/ -->
  </body>
</html>
