<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nmap</title>
    <meta name="description" content="A quickstart guide for Nmap">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Risky Hacker">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="Risky Hacker">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/">Risky Hacker</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/">Home</a></li>
        <li class="nav-item"><a href="/posts/">Archive</a></li>
        <li class="nav-item"><a href="/about/">About</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>Nmap</h1>

<blockquote>
<p>A quick start guide.</p>
</blockquote>
<h3 id="documentation">Documentation <a class="direct-link" href="#documentation">#</a></h3>
<p>Nmap has awesome website packed with great information. <a href="https://nmap.org/book/port-scanning-options.html">Port scanning</a> is a good enough synopsis to get you started. Checkout <a href="https://nmap.org/book/toc.html">the free online book</a> when you need an all exhaustive reference. The purchased edition has extra goodies in it. The man page is just as awesome as the website.</p>
<pre class="language-text"><code class="language-text"><mark class="highlight-line highlight-line-active"># Loaded with useful content (unlike some man pages)</mark><br><span class="highlight-line">➜  ~ man nmap</span><br><span class="highlight-line">NMAP(1)                                Nmap Reference Guide                                NMAP(1)</span><br><span class="highlight-line"></span><br><span class="highlight-line">NAME</span><br><span class="highlight-line">       nmap - Network exploration tool and security / port scanner</span><br><span class="highlight-line"></span><br><span class="highlight-line">SYNOPSIS</span><br><mark class="highlight-line highlight-line-active">       nmap [Scan Type...] [Options] {target specification}</mark></code></pre>
<h3 id="default-scan-%2F-half-open">Default Scan / Half Open <a class="direct-link" href="#default-scan-%2F-half-open">#</a></h3>
<p>If you don't supply any arguments, the default flags are <code>-sS</code>. If you ever need to search for what a flag means (for most linux CLI tools), don't fret, you're not limited to the man pages. Try <a href="https://explainshell.com"><code>explain shell</code></a>. I'll leave the explainations to explain shell and just show you common commands.</p>
<h4 id="nmap--ss-%7Btarget-specification%7D"><a href="https://explainshell.com/explain?cmd=nmap+-sS"><code>nmap -sS {target specification}</code></a> <a class="direct-link" href="#nmap--ss-%7Btarget-specification%7D">#</a></h4>
<pre class="language-text"><code class="language-text"><mark class="highlight-line highlight-line-active">➜  ~ nmap target.hacker</mark><br><span class="highlight-line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-20 03:31 UTC</span><br><span class="highlight-line">Nmap scan report for target.hacker (172.19.0.2)</span><br><span class="highlight-line">Host is up (0.000011s latency).</span><br><span class="highlight-line">Not shown: 984 closed ports</span><br><span class="highlight-line">PORT     STATE SERVICE</span><br><mark class="highlight-line highlight-line-active">21/tcp   open  ftp</mark><br><mark class="highlight-line highlight-line-active">22/tcp   open  ssh</mark><br><mark class="highlight-line highlight-line-active">23/tcp   open  telnet</mark><br><mark class="highlight-line highlight-line-active">25/tcp   open  smtp</mark><br><mark class="highlight-line highlight-line-active">111/tcp  open  rpcbind</mark><br><mark class="highlight-line highlight-line-active">139/tcp  open  netbios-ssn</mark><br><mark class="highlight-line highlight-line-active">445/tcp  open  microsoft-ds</mark><br><mark class="highlight-line highlight-line-active">512/tcp  open  exec</mark><br><mark class="highlight-line highlight-line-active">513/tcp  open  login</mark><br><mark class="highlight-line highlight-line-active">514/tcp  open  shell</mark><br><mark class="highlight-line highlight-line-active">1099/tcp open  rmiregistry</mark><br><mark class="highlight-line highlight-line-active">1524/tcp open  ingreslock</mark><br><mark class="highlight-line highlight-line-active">2121/tcp open  ccproxy-ftp</mark><br><mark class="highlight-line highlight-line-active">3306/tcp open  mysql</mark><br><mark class="highlight-line highlight-line-active">5432/tcp open  postgresql</mark><br><mark class="highlight-line highlight-line-active">6667/tcp open  irc</mark><br><span class="highlight-line">MAC Address: 02:42:AC:13:00:02 (Unknown)</span><br><span class="highlight-line"></span><br><span class="highlight-line">Nmap done: 1 IP address (1 host up) scanned in 0.17 seconds</span></code></pre>
<h3 id="version-scan">Version Scan <a class="direct-link" href="#version-scan">#</a></h3>
<p>You may notice this scan type takes longer than the half-open scan. The wait is justifiable because we need version numbers so we can scope potential vulnerabilities. If you ever need a scan status update while you're waiting, try pressing the spacebar.</p>
<h4 id="nmap--sv-%7Btarget-specification%7D"><a href="https://explainshell.com/explain?cmd=nmap+-sV"><code>nmap -sV {target specification}</code></a> <a class="direct-link" href="#nmap--sv-%7Btarget-specification%7D">#</a></h4>
<pre class="language-text"><code class="language-text"><mark class="highlight-line highlight-line-active">➜  ~ nmap -sV target.hacker</mark><br><span class="highlight-line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-20 03:49 UTC</span><br><span class="highlight-line"></span><br><mark class="highlight-line highlight-line-active"># spacebar</mark><br><mark class="highlight-line highlight-line-active">Stats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan</mark><br><mark class="highlight-line highlight-line-active">Service scan Timing: About 50.00% done; ETC: 03:49 (0:00:06 remaining)</mark><br><span class="highlight-line"></span><br><span class="highlight-line">Nmap scan report for target.hacker (172.19.0.2)</span><br><span class="highlight-line">Host is up (0.000011s latency).</span><br><span class="highlight-line">Not shown: 984 closed ports</span><br><span class="highlight-line">PORT     STATE SERVICE     VERSION</span><br><mark class="highlight-line highlight-line-active">21/tcp   open  ftp         vsftpd 2.3.4</mark><br><mark class="highlight-line highlight-line-active">22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)</mark><br><mark class="highlight-line highlight-line-active">23/tcp   open  telnet      Linux telnetd</mark><br><mark class="highlight-line highlight-line-active">25/tcp   open  smtp        Postfix smtpd</mark><br><mark class="highlight-line highlight-line-active">111/tcp  open  rpcbind     2 (RPC #100000)</mark><br><mark class="highlight-line highlight-line-active">139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</mark><br><mark class="highlight-line highlight-line-active">445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</mark><br><mark class="highlight-line highlight-line-active">512/tcp  open  exec?</mark><br><mark class="highlight-line highlight-line-active">513/tcp  open  login</mark><br><mark class="highlight-line highlight-line-active">514/tcp  open  tcpwrapped</mark><br><mark class="highlight-line highlight-line-active">1099/tcp open  java-rmi    GNU Classpath grmiregistry</mark><br><mark class="highlight-line highlight-line-active">1524/tcp open  ingreslock?</mark><br><mark class="highlight-line highlight-line-active">2121/tcp open  ftp         ProFTPD 1.3.1</mark><br><mark class="highlight-line highlight-line-active">3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5</mark><br><mark class="highlight-line highlight-line-active">5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7</mark><br><mark class="highlight-line highlight-line-active">6667/tcp open  irc         UnrealIRCd</mark><br><span class="highlight-line"># ... omit ...</span><br><span class="highlight-line">Nmap done: 1 IP address (1 host up) scanned in 152.74 seconds</span></code></pre>
<h3 id="verbosity%2C-timing%2C-and-pruning">Verbosity, Timing, and Pruning <a class="direct-link" href="#verbosity%2C-timing%2C-and-pruning">#</a></h3>
<p>You may want to try and speed up your scans. And likely you want to view the progress of ongoing scans. That's where verbosity and timing come in. Just like timing, there are multiple levels of verbosity. Triple verbosity (<code>-vvv</code>) lets you view ports as they are discovered. If no timing is specified (<code>-T</code>) then a default timing of <code>-T3</code> is assumed. Recommended typical use is <code>-T4</code>. Finally, you can prune the number of ports scanned (top 1000 by default) with <code>--top-ports</code> to scan specific ports.</p>
<h4 id="nmap--vvv--sv--t4---top-ports-20-%7Btarget-specification%7D"><a href="https://explainshell.com/explain?cmd=nmap++-vvv+-sV+-T4"><code>nmap -vvv -sV -T4 --top-ports 20 {target specification}</code></a> <a class="direct-link" href="#nmap--vvv--sv--t4---top-ports-20-%7Btarget-specification%7D">#</a></h4>
<pre class="language-text"><code class="language-text"><mark class="highlight-line highlight-line-active">➜  ~ nmap -vvv -sV -T4 --top-ports 20 target.hacker</mark><br><span class="highlight-line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-20 04:16 UTC</span><br><span class="highlight-line">NSE: Loaded 45 scripts for scanning.</span><br><span class="highlight-line">Initiating ARP Ping Scan at 04:16</span><br><span class="highlight-line">Scanning target.hacker (172.19.0.2) [1 port]</span><br><span class="highlight-line">Completed ARP Ping Scan at 04:16, 0.02s elapsed (1 total hosts)</span><br><span class="highlight-line">Initiating Parallel DNS resolution of 1 host. at 04:16</span><br><span class="highlight-line">Completed Parallel DNS resolution of 1 host. at 04:16, 0.00s elapsed</span><br><span class="highlight-line">DNS resolution of 1 IPs took 0.00s. Mode: Async [#: 1, OK: 1, NX: 0, DR: 0, SF: 0, TR: 1, CN: 0]</span><br><span class="highlight-line">Initiating SYN Stealth Scan at 04:16</span><br><span class="highlight-line">Scanning target.hacker (172.19.0.2) [20 ports]</span><br><mark class="highlight-line highlight-line-active">Discovered open port 3306/tcp on 172.19.0.2</mark><br><mark class="highlight-line highlight-line-active">Discovered open port 25/tcp on 172.19.0.2</mark><br><mark class="highlight-line highlight-line-active">Discovered open port 22/tcp on 172.19.0.2</mark><br><mark class="highlight-line highlight-line-active">Discovered open port 139/tcp on 172.19.0.2</mark><br><mark class="highlight-line highlight-line-active">Discovered open port 23/tcp on 172.19.0.2</mark><br><mark class="highlight-line highlight-line-active">Discovered open port 445/tcp on 172.19.0.2</mark><br><mark class="highlight-line highlight-line-active">Discovered open port 111/tcp on 172.19.0.2</mark><br><mark class="highlight-line highlight-line-active">Discovered open port 21/tcp on 172.19.0.2</mark><br><mark class="highlight-line highlight-line-active">Completed SYN Stealth Scan at 04:16, 0.02s elapsed (20 total ports)</mark><br><mark class="highlight-line highlight-line-active">Initiating Service scan at 04:16</mark><br><span class="highlight-line">Scanning 8 services on target.hacker (172.19.0.2)</span><br><span class="highlight-line">Completed Service scan at 04:16, 11.02s elapsed (8 services on 1 host)</span><br><span class="highlight-line">NSE: Script scanning 172.19.0.2.</span><br><span class="highlight-line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="highlight-line">Initiating NSE at 04:16</span><br><span class="highlight-line">Completed NSE at 04:16, 0.02s elapsed</span><br><span class="highlight-line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="highlight-line">Initiating NSE at 04:16</span><br><span class="highlight-line">Completed NSE at 04:16, 0.00s elapsed</span><br><span class="highlight-line">Nmap scan report for target.hacker (172.19.0.2)</span><br><span class="highlight-line">Host is up, received arp-response (0.000014s latency).</span><br><span class="highlight-line">Scanned at 2021-02-20 04:16:01 UTC for 11s</span><br><span class="highlight-line"></span><br><span class="highlight-line">PORT     STATE  SERVICE       REASON         VERSION</span><br><mark class="highlight-line highlight-line-active">21/tcp   open   ftp           syn-ack ttl 64 vsftpd 2.3.4</mark><br><mark class="highlight-line highlight-line-active">22/tcp   open   ssh           syn-ack ttl 64 OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)</mark><br><mark class="highlight-line highlight-line-active">23/tcp   open   telnet        syn-ack ttl 64 Linux telnetd</mark><br><mark class="highlight-line highlight-line-active">25/tcp   open   smtp          syn-ack ttl 64 Postfix smtpd</mark><br><mark class="highlight-line highlight-line-active">53/tcp   closed domain        reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">80/tcp   closed http          reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">110/tcp  closed pop3          reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">111/tcp  open   rpcbind       syn-ack ttl 64 2 (RPC #100000)</mark><br><mark class="highlight-line highlight-line-active">135/tcp  closed msrpc         reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">139/tcp  open   netbios-ssn   syn-ack ttl 64 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</mark><br><mark class="highlight-line highlight-line-active">143/tcp  closed imap          reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">443/tcp  closed https         reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">445/tcp  open   netbios-ssn   syn-ack ttl 64 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</mark><br><mark class="highlight-line highlight-line-active">993/tcp  closed imaps         reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">995/tcp  closed pop3s         reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">1723/tcp closed pptp          reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">3306/tcp open   mysql         syn-ack ttl 64 MySQL 5.0.51a-3ubuntu5</mark><br><mark class="highlight-line highlight-line-active">3389/tcp closed ms-wbt-server reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">5900/tcp closed vnc           reset ttl 64</mark><br><mark class="highlight-line highlight-line-active">8080/tcp closed http-proxy    reset ttl 64</mark><br><span class="highlight-line">MAC Address: 02:42:AC:13:00:02 (Unknown)</span><br><span class="highlight-line">Service Info: Host:  metasploitable.localdomain; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="highlight-line"></span><br><span class="highlight-line">Read data files from: /usr/bin/../share/nmap</span><br><span class="highlight-line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="highlight-line">Nmap done: 1 IP address (1 host up) scanned in 11.41 seconds</span><br><span class="highlight-line">           Raw packets sent: 21 (908B) | Rcvd: 21 (860B)</span></code></pre>
<h3 id="nmap-scripting-engine-(nse)">Nmap Scripting Engine (NSE) <a class="direct-link" href="#nmap-scripting-engine-(nse)">#</a></h3>
<p>There are lots of NSE scripts available on a fresh install of Nmap, but you also want to make sure the script database is updated.</p>
<h4 id="nmap---script-updatedb"><a href="https://explainshell.com/explain?cmd=nmap+--script-updatedb"><code>nmap --script-updatedb</code></a> <a class="direct-link" href="#nmap---script-updatedb">#</a></h4>
<pre class="language-text"><code class="language-text"><mark class="highlight-line highlight-line-active">➜  ~ nmap --script-updatedb</mark><br><span class="highlight-line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-20 04:31 UTC</span><br><span class="highlight-line">NSE: Updating rule database.</span><br><mark class="highlight-line highlight-line-active">NSE: Script Database updated successfully.</mark><br><span class="highlight-line">Nmap done: 0 IP addresses (0 hosts up) scanned in 0.29 seconds</span><br><span class="highlight-line">➜  ~ </span><br><mark class="highlight-line highlight-line-active">➜  ~ find /usr/share/nmap/scripts -type f -name '*ssl*'</mark><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-dh-params.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-cert-intaddr.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-cert.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-heartbleed.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-poodle.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-date.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-known-key.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-enum-ciphers.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/rmi-vuln-classloader.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/sslv2-drown.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/ssl-ccs-injection.nse</span><br><span class="highlight-line">/usr/share/nmap/scripts/sslv2.nse</span></code></pre>
<p>Now that we have a handy script, lets save the output. There are three versions of output. If you'd like all three (better to have and not need) then use the flag <code>-oA</code> followed by the output filename (no file extension).</p>
<h4 id="nmap---script%3D%7Bscriptname%7D"><a href="https://explainshell.com/explain?cmd=nmap+--script%3D"><code>nmap --script={scriptname}</code></a> <a class="direct-link" href="#nmap---script%3D%7Bscriptname%7D">#</a></h4>
<pre class="language-text"><code class="language-text"><mark class="highlight-line highlight-line-active">➜  ~ nmap -sV -T4 --top-ports 20 --script=vulners -oA vulners_top_ports_20 target.hacker</mark><br><span class="highlight-line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-20 04:47 UTC</span><br><span class="highlight-line">Nmap scan report for target.hacker (172.19.0.2)</span><br><mark class="highlight-line highlight-line-active"># ... omit ...</mark><br><span class="highlight-line">➜  ~ ls</span><br><span class="highlight-line">vulners_top_ports_20.gnmap  vulners_top_ports_20.nmap  vulners_top_ports_20.xml</span></code></pre>
<p>The output is a little noisy. Results like this are often times better views as a report. The linux utility <code>xsltproc</code> can convert the <code>.xml</code> output to an <code>.html</code> report.</p>
<h4 id="xsltproc--o-%7Boutput%7D.html-%7Binput%7D.xml"><a href="https://explainshell.com/explain?cmd=xsltproc+-o"><code>xsltproc -o {output}.html {input}.xml</code></a> <a class="direct-link" href="#xsltproc--o-%7Boutput%7D.html-%7Binput%7D.xml">#</a></h4>
<pre class="language-shell"><code class="language-shell"><span class="highlight-line">➜  ~ xsltproc -o vulners_top_ports_20.html vulners_top_ports_20.xml</span></code></pre>
<style>
.center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 100%;
  border: 0.1rem solid black;
}
</style>
<img  class="center" src="/img/xsltproc.png"/>
<h3 id="leveling-up-nmap">Leveling up Nmap <a class="direct-link" href="#leveling-up-nmap">#</a></h3>
<p>We obviously didn't cover Nmap exhaustively (saved as an exercise for the reader), nor did we touch on actually understanding the results, which is arguably the most important part. Nonetheless,there are a couple ways to more efficiently leverage Nmap, each with their own tradeoff. You may find you gain functionality in some areas, while losing functionality in others.</p>
<ul>
<li><a href="https://github.com/Tib3rius/AutoRecon">AutoRecon</a></li>
<li><a href="https://github.com/21y4d/nmapAutomator">NmapAutomator</a></li>
<li><a href="https://github.com/RustScan/RustScan">Rustscan</a></li>
</ul>


<hr>
<ul><li>Previous: <a href="/posts/hacking-reference/">Hacking Reference</a></li>
</ul>
    </main>

    <footer></footer>

    <!-- Current page: /posts/nmap/ -->
  </body>
</html>
